{"_id":{"$oid":"67036c3216331bddadadc2c8"},"scope":"complete","country":"us","engine":"chrome_vim","product_page_requires_account":"no","shipping_options_div_type":"none","end_delay":4000,"status":"live","old_status":"pending","website_url":"microsoft.com","website_name":"Microsoft","honey_id":"122","partial_urls":["microsoft.com","microsoft.com/en-us","microsoftstore.com","office.com","products.office.com/en","xbox.com","portal.office.com/Commerce"],"login_recording":[{"type":2,"info":{"tagName":"INPUT","value":"5d946a8c219e9938b864da44","checked":null,"name":"loginfmt","type":"text","src":"","id":"i0116","title":"","options":null,"selector":"input.form-control.ltr_override[name='loginfmt']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"username","field_type":""},{"type":20,"info":{"tagName":"INPUT","value":"Next","checked":null,"name":"","type":"submit","src":"","id":"idSIButton9","title":"","options":null,"selector":"input[id='idSIButton9']","is_optional":"no","frame":"","timeout":"","comment":""},"x":521,"y":443,"text":""},{"type":2,"info":{"tagName":"INPUT","value":"blihblah1234","checked":null,"name":"passwd","type":"text","src":"","id":"i0118","title":"","options":null,"selector":"input.form-control[name='passwd']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"password","field_type":""},{"type":20,"info":{"tagName":"INPUT","value":"Sign in","checked":null,"name":"","type":"submit","src":"","id":"idSIButton9","title":"","options":null,"selector":"input[id='idSIButton9']","is_optional":"no","frame":"","timeout":"","comment":""},"x":571,"y":448,"text":""}],"signup_recording":null,"title_div":{"selector":"html[lang=\"en-US\"] div.container .buybox h1 , h1#DynamicHeading_productTitle, body:not(:has(h1#DynamicHeading_productTitle)) div#titleGroupPageBar div div h1, h1#page-title, h1.ow-prod-name, body:has(#tt365) #uhfCatLogo, #ttTitle, *[id*=\"BlockList\"] *[class*=\"banner\"] h1:first","has_custom_selector":true},"brand_div":{"selector":"site_name","has_custom_selector":true},"price_div":{"selector":"html[lang=\"en-US\"] #currentPrice, body:not(:has(div.ttDEPrice)):not(:has(#skuDropdownList:contains($))) div.m-product-detail-hero-product-placement div.price-info span, body:not(:has(div.ttDEPrice)) div.ow-price-text:not(#owPriceText) div.ow-price-text span, body:not(:has(div.ttDEPrice)) body:not(:has(div.ow-price-text:not(#owPriceText) div.ow-price-text span)) #owPriceText, body:not(:has(div.ttDEPrice)) #tt365price, body:not(:has(div.ttDEPrice)) div#PageBarModuleHeaderArea div.total-price span.list-price, body:not(:has(div.ttDEPrice)) div.ordersummary span:contains(\"Subtotal\")+, div#ttDENPrice, div#ImageCollectionCarousel div.expOrderSummaryInfo div.exp-default-selection div.exp-summary-col-2, div#ImageCollectionCarousel div.exp-summary-container div.expOrderSummaryInfo div.exp-lstprice, body:not(:has(div.ttDEPrice)) #headerArea .list-price, #skuDropdownList:contains($), body:not(:has(li[class*=\"active\"][class*=\"hero-content\"])) .priceCTA:not(:has(.priceCTA)) .price-msrp:first, [class*=\"active\"][class*=\"hero-content\"] .price-msrp, body:not(:has(.price-msrp)) .priceCTA:not(:has(.priceCTA)) span:contains(\"$\"):first, body:not(:has(#headerArea .list-price:contains($))) #ttInitialPrice","has_custom_selector":true},"returns_div":null,"image_div":{"selector":"#image img, html[lang=\"en-US\"] #rootContainer_BuyBox div.buy-box-product-image picture img , div#productImage img, body:not(:has(#uhfCatLogo:contains('Microsoft 365'))) div.m-product-detail-hero-carousel li[id*='hero-slide'].f-active img, div#backgroundImage img, body:not(:has(#uhfCatLogo:contains('Microsoft 365'), div#productImage img)) div.m-hero-item img, div#ttImage img, section#mainArea[role=main] div.c-carousel[role=region] picture img, div#TwoColumnRegion div#ImageCollectionCarousel img, div[class*=\"image-collection-carousel\"] img, li[id*=\"media\"][class*=\"active\"] img, body:not(:has(#heroTabControls)) [id*=\"BlockList\"] [class*=\"carousel\"] img:first, body:not(:has(li[id*=\"media\"][class*=\"active\"] img)) div[id*=\"TopContentBlockList\"] img:first, html[lang=\"en-US\"] aside.productImage picture img","has_custom_selector":true},"alt_images_div":{"selector":"html[lang=\"en-US\"] #rootContainer_BuyBox div.buy-box-product-image picture img , div#backgroundimage img, div#productIdentityRoot img, div.m-product-detail-hero-carousel li[id*='hero-slide'] img, picture.ow-picture-auto img, div[class*=\"image-collection-carousel\"] img, li[id*=\"media\"] img, body:not(:has(#heroTabControls)) [id*=\"BlockList\"] [class*=\"carousel\"] img, html[lang=\"en-US\"] aside.productImage picture img","has_custom_selector":true},"custom_id_div":{"selector":"#ttCid","has_custom_selector":true},"extra_info_div":{"selector":"div#ButtonPanel_buttons button[aria-label='Pre-order'], div.PricingMessage[aria-label*='Release date'], #descriptionText button","has_custom_selector":true},"weight_div":null,"product_container_div":{"selector":"#productIdentityRoot div.pi-content","has_custom_selector":true},"add_to_cart_recording":[{"type":1010,"info":{"selector":"div#skuSelector button, button.pi-dropdown-trigger","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// option [davidkulcsar19] 2019-10-04\r\nvar result = [];\r\n\r\n// The two existence checks are meant to differentiate between the two types of product pages that fall under this attribute type.\r\n// Then the have a click in those existence checks to make options available in the DOM because they are not available in the DOM \r\n// in the first place.\r\n\r\nvar pdpTypeOne = __utils__.findOne(\"div#skuSelector button.pi-dropdown-trigger\");\r\nvar pdpTypeTwo = __utils__.findOne(\"//div[@id='skuSelector']//button[contains(@class,'c-action-trigger')]\");\r\nvar optsAvail = __utils__.findOne(\"//div[@id='cli_piFlyoutRoot']//div[@role='list']\");\r\n\r\n// PDP type 1 - Showing options that aren't available in the DOM \r\n// Ex: https://www.microsoft.com/en-us/p/controller-gear-xbox-design-lab-pro-charging-stand/8TVCQSJ7V6PT/14MT?atc=true\r\nif (IS_EXTENSION_FLAG !== true && !optsAvail && pdpTypeOne) {\r\n  __utils__.mouseEvent('click', pdpTypeOne);\r\n}\r\n\r\n// PDP type 1 - Showing options that aren't available in the DOM \r\n// Ex: https://www.microsoft.com/en-us/p/surface-go-type-cover-english/8VSZF6WTWF29/JB2T?activetab=pivot:overviewtab\r\nif (IS_EXTENSION_FLAG !== true && pdpTypeTwo) {\r\n  __utils__.mouseEvent('click', pdpTypeTwo);\r\n}\r\n  \r\nvar opts = __utils__.findAll(\"//div[@id='cli_piFlyoutRoot']//div[@role='list']/button | //div[@id='skuSelector']//button[contains(@class,'c-select-button')]\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim().length > 0 ? el.text().trim() : el.data() && el.data('selectedText');\r\n  __utils__.echo('elText = ' + elText);\r\n  result.push(elText);\r\n}\r\n\r\n\r\nreturn result;","set":"__utils__.echo('--- option fillValue = ' + fillValue);\r\nvar changed = false;\r\n\r\nvar pdpTypeOne = __utils__.findOne(\"div#skuSelector button.pi-dropdown-trigger\");\r\nvar pdpTypeTwo = __utils__.findOne(\"//div[@id='skuSelector']//button[contains(@class,'c-action-trigger')]\");\r\nvar optsAvail = __utils__.findOne(\"//div[@id='cli_piFlyoutRoot']//div[@role='list']\");\r\n\r\n// PDP type 1 - Showing options that aren't available in the DOM \r\n// Ex: https://www.microsoft.com/en-us/p/controller-gear-xbox-design-lab-pro-charging-stand/8TVCQSJ7V6PT/14MT?atc=true\r\nif (IS_EXTENSION_FLAG !== true && !optsAvail && pdpTypeOne) {\r\n  __utils__.mouseEvent('click', pdpTypeOne);\r\n}\r\n\r\n// PDP type 1 - Showing options that aren't available in the DOM \r\n// Ex: https://www.microsoft.com/en-us/p/surface-go-type-cover-english/8VSZF6WTWF29/JB2T?activetab=pivot:overviewtab\r\nif (IS_EXTENSION_FLAG !== true && pdpTypeTwo) {\r\n  __utils__.mouseEvent('click', pdpTypeTwo);\r\n}\r\n\r\nvar opts = __utils__.findAll(\"//div[@id='cli_piFlyoutRoot']//div[@role='list']/button | //div[@id='skuSelector']//button[contains(@class,'c-select-button')]\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim().length > 0 ? el.text().trim() : el.data() && el.data('selectedText');\r\n  __utils__.echo(\"----- el text = \" + elText);\r\n  if (_t_productPageStatus != 'product_info') {\r\n    __utils__.echo('---> el Text = ' + elText);\r\n  }\r\n  if (elText == fillValue) {\r\n    __utils__.mouseEvent('click', el);\r\n    if (_ttOOS()) { continue; }\r\n    changed = true;\r\n    _updateSku();\r\n    __utils__.echo('----- SET EL TEXT = ' + elText);\r\n  }\r\n}\r\n\r\n\r\n_ttDEPrice();\r\nreturn changed;","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"has_custom_selector":true,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"option","field_type":""},{"type":1010,"info":{"selector":".tt365","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-05-28\r\nvar result = [];\r\nvar opt = __utils__.findOne(\"div.tt365category\");\r\nvar elText = opt && opt.attr('title') && opt.attr('title').trim();\r\nif (elText) {\r\n  result.push(elText);\r\n}\r\nreturn result;","set":"__utils__.echo(\"category fillValue-----> \" + fillValue);\r\n\r\nvar changed  = false;\r\nvar opt = __utils__.findOne(\"div.tt365category\");\r\nvar elText = opt && opt.attr('title') && opt.attr('title').trim();\r\nif (elText == fillValue) {\r\n  var elId = opt.attr('ttid');\r\n  var allProducts = __utils__.findAll('.tt365prod');\r\n  for (var iPos = 0; iPos < allProducts.length; iPos ++) {\r\n    var product = allProducts[iPos];\r\n    product.attr(\"status\", \"inactive\");\r\n  }\r\n  var activeProducts = __utils__.findAll('//div[contains(@ttid, \"' + elId + '\")]/div[contains(@class, \"tt365prod\")]');\r\n  for (var iPos = 0; iPos < activeProducts.length; iPos ++) {\r\n    var product = activeProducts[iPos];\r\n    product.attr(\"status\", \"active\");\r\n  }\r\n  __utils__.echo(\"category MATCH:  \" + elText + \" :: \" + fillValue);\r\n  changed = true;\r\n  _updateSku();\r\n}\r\n_ttDEPrice();\r\nreturn changed;","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"has_custom_selector":true,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"category","field_type":""},{"type":1010,"info":{"selector":".tt365","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-05-28\r\nvar result = [];\r\nvar opts = __utils__.findAll(\"//div[contains(@class, 'tt365prod')][@status='active']\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim();\r\n  result.push(elText);\r\n}\r\nreturn result;","set":"__utils__.echo(\"product fillValue-----> \" + fillValue);\r\nvar changed = false;\r\nvar opts = __utils__.findAll(\"//div[contains(@class, 'tt365prod')][@status='active']\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim();\r\n  if (elText == fillValue) {\r\n    var elPrice = el.attr('price');\r\n    $('div#tt365price').html(elPrice);\r\n    __utils__.echo(\"product MATCH:  \" + elText + \" :: \" + fillValue);\r\n    changed = true;\r\n    _updateSku();\r\n  }\r\n}\r\n_ttDEPrice();\r\nreturn changed;","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"has_custom_selector":true,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"product","field_type":""},{"type":1010,"info":{"selector":"div.cli_skuDropdownSelector:has(#skuDropdownList)","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joel.rhine] 2020-12-02\r\nvar result = [];\r\nvar opts = __utils__.findAll(\"//li[@data-sku-id]/a\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim();\r\n  result.push(elText);\r\n}\r\nreturn result;","set":"__utils__.echo(\"product fillValue-----> \" + fillValue);\r\nvar changed = false;\r\nvar opts = __utils__.findAll(\"//li[@data-sku-id]/a\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.text().trim();\r\n  if (elText == fillValue) {\r\n    __utils__.echo(\"product MATCH:  \" + elText + \" :: \" + fillValue);\r\n    __utils__.mouseEvent('click', el);\r\n    changed = true;\r\n    _updateSku();\r\n  }\r\n}\r\n_ttDEPrice();\r\nreturn changed;","current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":"","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null},"field_key":"value","field_type":""},{"type":1010,"info":{"selector":"//*[@ttmark1=\"true\"]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-07-16\r\nreturn _ttAttrGet(1);","set":"return _ttAttrSet(fillValue, 1);","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":"","has_custom_selector":true},"field_key":"option 1","field_type":""},{"type":1010,"info":{"selector":"//*[@ttmark2=\"true\"]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-07-17\r\nreturn _ttAttrGet(2);","set":"return _ttAttrSet(fillValue, 2);\r\n","has_custom_selector":true,"set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"option 2","field_type":""},{"type":1010,"info":{"selector":"//*[@ttmark3=\"true\"]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-07-17\r\nreturn _ttAttrGet(3);","set":"return _ttAttrSet(fillValue, 3);","has_custom_selector":true,"set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"option 3","field_type":""},{"type":1010,"info":{"selector":"//*[@ttmark4=\"true\"]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-07-17\r\nreturn _ttAttrGet(4);","set":"return _ttAttrSet(fillValue, 4);","has_custom_selector":true,"set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"option 4","field_type":""},{"type":1010,"info":{"selector":"//*[@ttmark5=\"true\"]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [joshua.bracks] 2020-07-17\r\nreturn _ttAttrGet(5);\r\n","set":"return _ttAttrSet(fillValue, 5);","has_custom_selector":true,"set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":""},"field_key":"option 5","field_type":""},{"type":1010,"info":{"selector":"//body[.//ul[contains(@id,\"heroTabControls\")]]//ul[@id=\"heroTabControls\"] | //div[contains(@class, 'filtersku')]//div[contains(@class, 'colorpicker')]","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"// created by [ata.ahmad] 2021-09-16\r\nvar result = [];\r\nvar opts = __utils__.findAll('//body[.//ul[contains(@id,\"heroTabControls\")]]//ul[@id=\"heroTabControls\"]//li | ' + \r\n          \"//div[contains(@class, 'filtersku')]//div[contains(@class, 'colorpicker')]//button\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.find('p').text().trim() || el.attr('alt-text');\r\n  result.push(elText);\r\n}\r\nreturn result;","set":"__utils__.echo('--- COLOR fillValue = ' + fillValue);\r\nvar changed = false;\r\nvar opts = __utils__.findAll('//body[.//ul[contains(@id,\"heroTabControls\")]]//ul[@id=\"heroTabControls\"]//li | ' + \r\n          \"//div[contains(@class, 'filtersku')]//div[contains(@class, 'colorpicker')]//button\");\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n  var el = opts[iPos];\r\n  var elText = el.find('p').text().trim() || el.attr('alt-text');\r\n  if (elText == fillValue) {\r\n    var v1Button = __utils__.findOne('p', el);\r\n    __utils__.mouseEvent('click', v1Button || el);\r\n    changed = true;\r\n    _updateSku();\r\n  }\r\n}\r\nreturn changed;","has_custom_selector":true,"current_variant_selector":".filtersku button[data-key=\"filtercolor\"]","current_variant_selector_property":"","current_variant_selector_regex":"","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"found here: xbox.com/en-US/accessories/controllers/xbox-wireless-controller","options":null,"checked":null},"field_key":"color","field_type":""},{"type":1010,"info":{"selector":".filtersku [aria-label=\"Configuration\"], select[name=\"sku-selector\"], fieldset:has(legend:contains(\"configuration\")):has(div.custom-radio:has(input[name=\"sku-selector\"]))","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","tagName":"INPUT","type":"text","get":"var result = [];\r\nvar opts = __utils__.findAll('select[name=\"sku-selector\"] option, ' + \r\n    'fieldset:has(legend:contains(\"configuration\")):has(div.custom-radio:has(input[name=\"sku-selector\"])) div.custom-radio label, ' + \r\n    '.filtersku [aria-label=\"Configuration\"] button:not([disabled]) h4');\r\nfor(var iPos = 0; iPos < opts.length; iPos++) {\r\n    var el = opts[iPos];\r\n    var elText = el.text().trim();\r\n    var isRadio_Or_isNewCustom = el.parent().hasClass('custom-radio') || __utils__.findOne('.filtersku [aria-label=\"Configuration\"]');\r\n    \r\n    if (!isRadio_Or_isNewCustom) {\r\n      var elValue = el.val().trim();\r\n      var obj = { text: elText, value: elValue };\r\n      result.push(obj);\r\n    } else result.push(elText);\r\n}\r\nreturn result;","set":"var changed = false;\r\nvar opts = __utils__.findAll('select[name=\"sku-selector\"] option, ' + \r\n    'fieldset:has(legend:contains(\"configuration\")):has(div.custom-radio:has(input[name=\"sku-selector\"])) div.custom-radio label, ' + \r\n    '.filtersku [aria-label=\"Configuration\"] button:not([disabled]) h4');\r\nfor (var iPos = 0; iPos < opts.length; iPos++) {\r\n    var el = opts[iPos];\r\n    var isRadio_Or_isNewCustom = el.parent().hasClass('custom-radio') || __utils__.findOne('.filtersku [aria-label=\"Configuration\"]');\r\n    var elValue = isRadio_Or_isNewCustom ? el.text().trim() : el.val().trim();\r\n    \r\n    if (elValue == fillValue) {\r\n      if (isRadio_Or_isNewCustom) __utils__.mouseEvent('click', el);\r\n      else {\r\n        el.parent().val(el.val());\r\n        __utils__.mouseEvent('change', el.parent());\r\n      }\r\n      changed = true;\r\n      _updateSku();\r\n    }\r\n}\r\nreturn changed;","current_variant_selector":"","current_variant_selector_property":"","current_variant_selector_regex":"","set_during_retrieve_opts":"true","reset_during_retrieve_opts":"no","only_on_checkout_type":"","comment":"","options":null,"checked":null,"has_custom_selector":true},"field_key":"configuration","field_type":""},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"buttons_AddToCartButton","title":"","options":null,"selector":"//div[@id=\"rootContainer_BuyBox\"]/section[contains(@class, \"buy-box\")]//div[contains(@class, \"buy-box-right-col\")]//div/a[@aria-label=\"Add to cart\" and contains(@class, \"btn-primary\")] | //body[not(//h1[@id=\"DynamicHeading_productTitle\"][contains(text(),\"Digital Code\")])]//div[@id=\"ButtonPanel_buttons\"]//button[@aria-label=\"Add to cart\" or @aria-label=\"Pre-order\" or @aria-label=\"In den Warenkorb\" or @aria-label=\"Vorbestellen\"] | //button[@id=\"PhysicalGoodIdentityBuyButton\"] | //button[@id = \"buttonPanel_AddToCartButton\"] | //button[@id=\"exp-WebbuttonPanelPre_AddToCartButton\"] | //div[contains(@class, \"ow-price-container\")]//div[@class=\"ow-price-button\"][not(contains(@id, \"owFirstPriceButton\"))]/a | //div[contains(@class, \"ow-price-container\")]//div[@id=\"owFirstPriceButton\"]/a | //button[@id=\"WebbuttonPanelPre_AddToCartButton2\"] | //a[contains(@class, \"ttcart\")] | //section[@id=\"mainArea\"]//button[contains(@class, \"c-button\")][not(ancestor-or-self::*[contains(@id,\"FindInStore\")])][not(@disabled)] | //div[contains(@class, \"ordersummary\")]//div[contains(@class, \"checkout-button\")]//button[not(contains(@disabled, \"disabled\"))] | //div[@id=\"ButtonPanel_buttons\"]//button[@id=\"buttons_AddToCartButton\"] | //button[@aria-disabled=\"false\"][@id=\"buttonPanel_AppIdentityBuyButton\"] | //*[contains(@id,\"primaryArea\") or contains(@id,\"mainArea\")]//button[contains(text(), \"Add to cart\")] | //div[contains(@class,\"priceCTA\")]//a[contains(@class,\"addToCartBtn\") or contains(@data-bi-name,\"add to cart\")] | //button[contains(@aria-label, \"Pre-order\")]","is_optional":"no","frame":"","timeout":"","only_on_checkout_type":"","comment":"","checked":null,"has_custom_selector":true},"x":365,"y":853,"text":"Add to cart"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","only_on_checkout_type":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"selector":"div#pi-lightbox-id button.glyph-cancel","frame":"","is_optional":"yes","interval":"","js_code":null,"timeout":"","only_on_checkout_type":"","comment":"","options":null,"checked":null}}],"add_to_cart_changes_div":{"selector":"span.shopping-cart-amount","has_custom_selector":true},"remove_from_cart_recording":[{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"submit","id":"","title":"","options":null,"selector":"div.item-description button.c-action-trigger[aria-label*='Remove']","has_custom_selector":true,"frame":"","timeout":"","comment":"","checked":null},"x":151,"y":260,"text":"Remove"}],"order_error_divs":[{"selector":"//span[contains(@class,'pidlddc-error')][not(contains(@style,'none'))]","overwrite":"text"},{"selector":"div.alert-error","overwrite":"text"},{"selector":"div.cli-alert-message","overwrite":"text"}],"notes":"KNOWN ISSUES:\r\n--> https://www.microsoft.com/fr-ca/microsoft-365/p/microsoft-365-personnel/cfq7ttc0k5bf\r\nwe need to block french language products since these will overwrite the english language products on microsoft canada.\r\n\r\npre-release products w/o add to cart cannot be supported, we will block them\r\n--> https://www.xbox.com/en-us/accessories/controllers/daystrike-camo-special-edition\r\nthe reason for this is that while we could potentially create a custom ID for them, they would always be OOS, and once they get their add to cart button the custom ID would change.\r\n\r\nMS 365 appears to be going through the process to be its own store, see https://joinhoney.atlassian.net/browse/IM-59222\r\nMS 365 domains now default not to microsoft.com store but its own. depending on what partnerships says, we may not need to support these products. (they don't go into cart anyway and are marked as non-purchasable)\r\n\r\nGID NOTES:\r\nGID is built using CustomId:\r\nsince the store has a couple different URL schemas, we must check for the URL type before attempting to extract the customId from it. this is achieved via a function in prodOpts which takes a regex as its argument since different product page types need different regex. \r\n\r\nXBOX.COM PRODUCTS:\r\nhave customId as productId in the [data-bi-product] attribute on their add to cart button, these require no regex:\r\n--> https://www.xbox.com/en-us/accessories/mobile-gaming/moga-xp5-x → 905TRZ32LZL7\r\nselector: a[data-bi-name=\"add to cart\"]:first\r\n\r\nNON MS365 PRODUCTS:\r\nmicrosoft.com products have customId as productID in URL( location.href ):\r\n--> https://www.microsoft.com/en-us/p/surface-headphones-2/8WQ0BSX7G523?activetab=pivot%3aoverviewtab&atc=true&icid=mscom_marcom_CPH4b_SurfaceHeadphones2 → 8WQ0BSX7G523\r\nregex: .*microsoft\\.com\\/en-us\\/(?:store\\/configure|p|store\\/d)\\/[^/]*\\/([^/]+?)[/?#&].*\r\n\r\nMS365 PRODUCTS:\r\nhave customId as URL title-slug since they do not all have a productId:\r\n--> https://www.microsoft.com/en-us/microsoft-365/p/office-home-student-2019/CFQ7TTC0K7C8?activetab=pivot%3aoverviewtab → OFFICE-HOME-STUDENT-2019 regex: .*microsoft\\.com\\/en-us\\/microsoft-365\\/([^?&]*).*\r\n\r\nMS365 BUSINESS PRODUCTS:\r\nare the same as ms365 products except they have a different regex:\r\nhttps://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-apps-for-business?activetab=pivot:overviewtab → MICROSOFT-365-APPS-FOR-BUSINESS\r\nregex: .*microsoft\\.com\\/en-us\\/microsoft-365\\/(?:p|buy|business)\\/([^/?]*).*\r\n\r\nOffice 365\r\nhttps://www.microsoft.com/en-us/microsoft-365/p/microsoft-365-family/cfq7ttc0k5dm?activetab=pivot%3aoverviewtab\r\nhttps://www.microsoft.com/en-us/microsoft-365/p/microsoft-365-personal/cfq7ttc0k5bf?activetab=pivot%3aoverviewtab\r\nhttps://www.microsoft.com/en-us/microsoft-365/p/office-home-student-2019/CFQ7TTC0K7C8?activetab=pivot%3aoverviewtab\r\nhttps://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-business-basic?activetab=pivot%3aoverviewtab\r\nhttps://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-business-standard?activetab=pivot%3aoverviewtab\r\nhttps://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-apps-for-business?activetab=pivot:overviewtab\r\nOffice 365 Multi Product Page\r\nhttps://www.microsoft.com/en-us/microsoft-365/compare-all-microsoft-365-products?activetab=tab:primaryr1\r\n\r\n*** shipping options removed (for now) because some products can only be shipped via cheapest\r\n\r\nConfigurable / GID Edge Case\r\nthe configurable product page detector has been updated [12-2-2020]\r\nthere is a difference between the some configurable URLs and their actual product pages, for example:\r\nhttps://www.microsoft.com/en-us/p/cyberpowerpc-msaag2000-xtreme-gaming-desktop/93hvwtnm2s4g?atc=true&activetab=pivot:overviewtab (non-Product)\r\nVS.\r\nhttps://www.microsoft.com/en-us/store/configure/CYBERPOWERPC-MSAAG2000-Xtreme-Gaming-Desktop/93HVWTNM2S4G?crosssellid=pcgamingdesktopinterstitial&selectedColor=&preview=&previewModes= (non-Surface configurable Product Page)\r\n\r\nhttps://www.microsoft.com/en-us/store/configure/Surface-Go-2/8PT3S2VJMDR6?crosssellid=fbt-p1c&selectedColor=&preview=&previewModes=&source=lp\r\n------------------------------------------------------------------------------------------\r\nXBOX ACCESSORIES ON XBOX.COM:\r\nthese new xbox accessory product types have 3 different styles:\r\nMULTIPLE VARIANTS: \r\n--> https://www.xbox.com/en-US/accessories/controllers/xbox-wireless-controller#\r\n\r\nSINGLE VARIANT:\r\n--> https://www.xbox.com/en-us/accessories/controllers/elite-wireless-controller-series-2\r\n--> https://www.xbox.com/en-US/accessories/controllers/grey-green\r\nSALE SINGLE:\r\n--> https://www.xbox.com/en-us/accessories/mobile-gaming/moga-xp5-x\r\n\r\nNO \"price-msrp\" CLASS:\r\nhttps://www.xbox.com/en-US/accessories/controllers/xbox-adaptive-controller\r\n\r\n------------------------------------------------------------------------------------------\r\noption\r\nhttps://www.microsoft.com/en-us/p/surface-pro-6-type-cover/8VVGCGKPSWS0/3P91                                 -v1\r\nhttps://www.microsoft.com/en-us/p/microsoft-surface-pro-certified-refurbished/8PG9R8WB09L0/D49K   - v2\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\nfiltered with add to cart selector:\r\nhttps://www.microsoft.com/en-us/p/surface-pro-6/8ZCNC665SLQ5/LGVZ - configure\r\nhttps://www.microsoft.com/en-us/p/surface-earbuds/920bnghqjshs           - coming soon \r\nhttps://www.microsoft.com/en-us/p/surface-laptop-2-essentials-bundle/8zk2xnlx4d6r - bundle\r\nhttps://www.microsoft.com/en-us/p/microsoft-gift-card-digital-code/cfq7ttc0k61w/000v - digital gift card\r\nhttps://www.microsoft.com/en-us/p/itunes/9pb2mz1zmb1s     - get (application)\r\nhttps://www.microsoft.com/en-us/p/xbox-live-gold/cfq7ttc0k5dj - join\r\nhttps://www.microsoft.com/en-us/p/ark-survival-evolved/bnblc4zgfnkb  - buy (downloadable games)\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\nextra info\r\n\"Pre-order\"\r\nhttps://www.microsoft.com/en-us/p/surface-pen/92FP8Q09QHXC/JZM2 \r\n\r\n\"release date\"\r\nhttps://www.microsoft.com/en-us/p/surface-pen/92FP8Q09QHXC/JZM2 \r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\nneeds to close popup after clicking on the add to cart button\r\nhttps://www.microsoft.com/en-us/p/acer-swift-5-sf515-51t-53ay-laptop/8rvngfxnts4l/09vp?activetab=pivot%3aoverviewtab\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\npreselected option in the title\r\nhttps://www.microsoft.com/en-us/p/uag-metropolis-surface-go-case/8W4JMM6L9261/MD33\r\nhttps://www.microsoft.com/en-us/p/microsoft-surface-studio-certified-refurbished/8T0RW4PT6NT4/C2GK\r\nhttps://www.microsoft.com/en-us/p/microsoft-surface-pro-certified-refurbished/8PG9R8WB09L0/D49K\r\n\r\ndifferent title based on the selected option\r\nhttps://www.microsoft.com/en-us/p/surface-go-signature-type-cover/90KBCCPW6FSV/J2PZ\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\nweight\r\nhttps://www.microsoft.com/en-us/p/acer-swift-5-sf515-51t-53ay-laptop/8rvngfxnts4l -lbs and kg\r\n\r\n-----------------------------------------------------------------------------------------------------------------------------------------------\r\nGID Notes\r\nnot using the title because the same product can have a different title\r\nhttps://www.microsoft.com/en-us/p/surface-go-signature-type-cover/90KBCCPW6FSV/J2PZ\r\n\r\nInstead - we are using title-slug. There are 3-kinds of product-urls that we should look out for:\r\nMicrosoft 365 URLs\r\n- https://www.microsoft.com/en-us/microsoft-365/p/office-home-student-2018/cfq7ttc0k7c8\r\n- https://www.microsoft.com/en-us/microsoft-365/p/word-home-and-student/cfq7ttc0k7ck\r\n- https://www.microsoft.com/en-us/microsoft-365/p/visio-professional-2019/CFQ7TTC0K7CG/0003\r\nDifferent 365 URLs\r\n- \r\nConfigure URLs\r\n- https://www.microsoft.com/en-us/store/configure/Surface-Laptop-3-for-Business/93N7B0KDZNCC\r\n- https://www.microsoft.com/en-us/store/configure/Surface-Laptop-Go-for-Business/8NR6D2WCLC72\r\n- https://www.microsoft.com/en-us/store/configure/Surface-Pro-7-for-Business/8QPR2SD9ZTFW\r\n\"p\" URLs\r\n- https://www.microsoft.com/en-us/p/machinarium/9ncjpcc7jn2m\r\n- https://www.microsoft.com/en-us/p/turtle-beach-recon-chat-xbox-one/8ZFM1D39DZWP/62BD\r\n- https://www.microsoft.com/en-us/p/lenovo-legion-y540-81sy0008us-gaming-pc/91p7gx86tgp9\r\n\r\nUPDATED by Joel \"rhonen\" Rhine - 03-26-2021\r\nXBOX.COM PRODUCTS: \r\nit appears that only some accessories at the moment have xbox.com pdp domains. https://www.xbox.com/en-US/accessories\r\nKNOWN-ISSUES: \r\n--> many of these products will tether to cart as far as i've found since they may have a different title-slug for their microsoft.com PDP url at cart\r\n--> many of these products will under-group with their microsoft.com, we have accepted this as a side-effect of supporting xbox.com\r\n\r\nSUPPORTED:\r\n    ACCESSORIES: mainly products in the controllers category appear to have xbox.com PDP urls\r\n\r\nNOT SUPPORTED:\r\n    GAMES: none appear to be supportable as they require login and are attached to a user’s MS live account\r\n    PCs: all appear to be re-routed to http://microsoft.com \r\n    CONSOLES: all appear to redirect to vendors\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------------\r\nUNSUPPORTABLE PRODUCTS\r\nthere are some digital products that are unsupportable due to the fact that they do not get added to \r\na cart and require a microsoft account to be purchased\r\n\r\nDigital Movies:\r\nhttps://www.microsoft.com/en-us/p/jumanji-the-next-level-bonus/8D6KGWXN1HLN/0001?atc=true&wa=wsignin1.0&lc=1033&activetab=pivot:overviewtab\r\n\r\nDigital App Downloads:\r\nhttps://www.microsoft.com/en-us/p/seekers-notes-hidden-journey/9nblggh69kbc?atc=true&activetab=pivot:overviewtab\r\n\r\nUPDATE [Ata Ahmad 9/22/2021]:\r\nAdded support for \"Configuration\" attributes (Dropdown and radio buttons):\r\nhttps://www.microsoft.com/en-us/d/surface-arc-mouse/8mrmszc6vxkc\r\nhttps://www.microsoft.com/en-us/d/xbox-wireless-controller/8xn59crbsqgz","sku_identifier":{"selector":".ttSku","has_custom_selector":true},"mpn_identifier":null,"gtin_identifier":null,"final_price_div_auth":{"tagName":"SPAN","id":"ember1225","title":"","options":[],"selector":"#orderSummaryPriceInfo .order-total-amount .ember-view","url":"https://www.microsoft.com/en-US/store/buy/checkout","recording_idx":"46","frame":""},"shipping_price_div_auth":{"tagName":"DIV","id":"","title":"","options":[],"selector":"#order-subtotal-shipping-price .pos-bottom-right","url":"https://www.microsoft.com/en-US/store/buy/checkout","recording_idx":"46","frame":""},"handling_price_div_auth":null,"checkout_recording_auth":[{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"submit","id":"","title":"","options":null,"selector":"//section/div/div/button","is_optional":"no","frame":"","timeout":"","comment":"","checked":null,"has_custom_selector":true},"x":670,"y":469,"text":"Checkout"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"15000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"selector":"button[aria-label='Edit Shipping']","frame":"","is_optional":"yes","interval":"","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"ember1055","title":"","options":null,"selector":"button.caption.cli-change-address","is_optional":"yes","frame":"","timeout":"","comment":"","checked":null,"has_custom_selector":true},"x":249,"y":299,"text":"Change"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":1001,"info":{"selector":"#addressesRadioContainer button.c-glyph.glyph-add-to.cli-add-address","frame":"","is_optional":"no","interval":"","js_code":"// created by [andrew.williams] 2019-12-06\r\n$('#addressesRadioContainer button.c-glyph.glyph-add-to.cli-add-address').click();","timeout":"","comment":"","options":null,"checked":null}},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":2,"info":{"tagName":"INPUT","value":"SFName","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_first_name","title":"","options":null,"selector":"#pidlddc-div-first_name input#cart_paymentInstrument_first_name","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_first_name","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"SLName","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_last_name","title":"","options":null,"selector":"#pidlddc-div-last_name input#cart_paymentInstrument_last_name","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_last_name","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"415","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_address_line1","title":"","options":null,"selector":"[id='pidlddc-div-address_line1'] input[id='cart_paymentInstrument_address_line1']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_address","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"Pratt ln","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_address_line2","title":"","options":null,"selector":"[id='pidlddc-div-address_line2'] input[id='cart_paymentInstrument_address_line2']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_address_2","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"palo alto","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_city","title":"","options":null,"selector":"#pidlddc-div-city input#cart_paymentInstrument_city","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_city","field_type":""},{"type":1001,"info":{"selector":"body","frame":"","is_optional":"no","interval":"","js_code":"// show hidden select [davidkulcsar19] 2019-10-04\r\n$(\"select\").show();","timeout":"","comment":"","options":null,"checked":null}},{"type":2,"info":{"tagName":"SELECT","value":"ca","name":"","type":"select-one","id":"cart_paymentInstrument_region","title":"","options":[{"text":"Alabama","value":"al"},{"text":"Alaska","value":"ak"},{"text":"Arizona","value":"az"},{"text":"Arkansas","value":"ar"},{"text":"Armed Forces Africa","value":"ae"},{"text":"Armed Forces America","value":"aa"},{"text":"Armed Forces Pacific","value":"ap"},{"text":"California","value":"ca"},{"text":"Colorado","value":"co"},{"text":"Connecticut","value":"ct"},{"text":"Delaware","value":"de"},{"text":"Florida","value":"fl"},{"text":"Georgia","value":"ga"},{"text":"Hawaii","value":"hi"},{"text":"Idaho","value":"id"},{"text":"Illinois","value":"il"},{"text":"Indiana","value":"in"},{"text":"Iowa","value":"ia"},{"text":"Kansas","value":"ks"},{"text":"Kentucky","value":"ky"},{"text":"Louisiana","value":"la"},{"text":"Maine","value":"me"},{"text":"Maryland","value":"md"},{"text":"Massachusetts","value":"ma"},{"text":"Michigan","value":"mi"},{"text":"Minnesota","value":"mn"},{"text":"Mississippi","value":"ms"},{"text":"Missouri","value":"mo"},{"text":"Montana","value":"mt"},{"text":"Nebraska","value":"ne"},{"text":"Nevada","value":"nv"},{"text":"New Hampshire","value":"nh"},{"text":"New Jersey","value":"nj"},{"text":"New Mexico","value":"nm"},{"text":"New York","value":"ny"},{"text":"North Carolina","value":"nc"},{"text":"North Dakota","value":"nd"},{"text":"Ohio","value":"oh"},{"text":"Oklahoma","value":"ok"},{"text":"Oregon","value":"or"},{"text":"Pennsylvania","value":"pa"},{"text":"Puerto Rico","value":"pr"},{"text":"Rhode Island","value":"ri"},{"text":"South Carolina","value":"sc"},{"text":"South Dakota","value":"sd"},{"text":"Tennessee","value":"tn"},{"text":"Texas","value":"tx"},{"text":"Utah","value":"ut"},{"text":"Vermont","value":"vt"},{"text":"Virginia","value":"va"},{"text":"Washington","value":"wa"},{"text":"Washington D.C.","value":"dc"},{"text":"West Virginia","value":"wv"},{"text":"Wisconsin","value":"wi"},{"text":"Wyoming","value":"wy"}],"selector":"#pidlddc-div-region select#cart_paymentInstrument_region","is_optional":"no","frame":"","timeout":"","text_only":"","comment":"","checked":null},"text":"AlabamaAlaskaArizonaArkansasArmed Forces AfricaArmed Forces AmericaArmed Forces PacificCaliforniaColoradoConnecticutDelawareFloridaGeorgiaHawaiiIdahoIllinoisIndianaIowaKansasKentuckyLouisianaMaineMarylandMassachusettsMichiganMinnesotaMississippiMissouriMontanaNebraskaNevadaNew HampshireNew JerseyNew MexicoNew YorkNorth CarolinaNorth DakotaOhioOklahomaOregonPennsylvaniaPuerto RicoRhode IslandSouth CarolinaSouth DakotaTennesseeTexasUtahVermontVirginiaWashingtonWashington D.C.West VirginiaWisconsinWyoming","field_key":"shipping_state","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"94303","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_postal_code","title":"","options":null,"selector":"#pidlddc-div-postal_code input#cart_paymentInstrument_postal_code","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_zip","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"6501231324","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_phone_number","title":"","options":null,"selector":"#pidlddc-div-phone_number input#cart_paymentInstrument_phone_number","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"shipping_telephone","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"on","checked":false,"name":"","type":"checkbox","src":"","id":"ember1134","title":"","options":null,"label":"Make this my default shipping address","selector":"input.ember-checkbox.ember-view","is_optional":"no","frame":"","timeout":"","comment":"","has_custom_selector":true},"text":"","field_key":"save_shipping","field_type":"hardcode"},{"type":20,"info":{"tagName":"BUTTON","value":"Save","name":"","type":"button","id":"pidlddc-button-saveButton","title":"","options":null,"selector":"#pidlddc-div-pagesubmitblock-div button#pidlddc-button-saveButton","is_optional":"no","frame":"","timeout":"","comment":"","checked":null},"x":249,"y":1282,"text":"Save"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"5000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":1001,"info":{"selector":"body","frame":"","is_optional":"no","interval":"","js_code":"// show hidden radio [davidkulcsar19] 2019-10-11\r\n$(\"input[type='radio'\").attr('style','opacity:1; width:20px; height:20px');","timeout":"","comment":"","options":null,"checked":null}},{"type":2,"info":{"tagName":"INPUT","value":"originalAddress","checked":null,"name":"addressValidation","type":"radio","src":"","id":"ember1154","title":"","options":[{"text":"originalAddress","value":"originalAddress"},{"text":"suggestedAddress0","value":"suggestedAddress0"}],"label":"415 Pratt ln palo alto , California 94303 Edit","selector":"input.ember-view[name='addressValidation']","is_optional":"yes","frame":"","timeout":"","comment":"","has_custom_selector":true},"text":"","field_key":"use_as_entered","field_type":"hardcode"},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"submit","id":"addressValidationSaveShippingAddress","title":"","options":null,"selector":"button#addressValidationSaveShippingAddress","is_optional":"yes","frame":"","timeout":"","comment":"","checked":null,"has_custom_selector":true},"x":487,"y":1181,"text":"Use this address"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"ember825","title":"","options":null,"selector":"button[aria-label='Edit Shipping']","has_custom_selector":true,"is_optional":"yes","frame":"","timeout":"","comment":"sometimes there's only one ship option that cannot be changed","checked":null},"x":574,"y":205,"text":"Edit"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"10000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"selector":"button[aria-label='Cancel Shipping']","frame":"","is_optional":"yes","interval":"","js_code":null,"timeout":"","comment":"in case of the shipping option didn't changed","options":null,"checked":null}},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"ember1189","title":"","options":null,"selector":"div.checkout-drawer-tile-payment button.caption.checkout-drawer-tile-btn","is_optional":"no","frame":"","timeout":"","comment":"","checked":null,"has_custom_selector":true},"x":584,"y":410,"text":"Edit"},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"ember1200","title":"","options":null,"selector":"button.caption.cli-change-pi.btn.theme-default.btn-link.ember-view","is_optional":"no","frame":"","timeout":"","comment":"","checked":null,"has_custom_selector":true},"x":249,"y":498,"text":"Change"},{"type":20,"info":{"tagName":"BUTTON","value":"","name":"","type":"button","id":"ember1212","title":"","options":null,"selector":"#paymentInstrumentsContainer button.c-glyph.glyph-add-to.btn.theme-default.btn-link.ember-view","is_optional":"no","frame":"","timeout":"","comment":"","checked":null},"x":210,"y":579,"text":"Add a new payment method"},{"type":1000,"info":{"selector":null,"frame":"","is_optional":"no","interval":"20000","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":1001,"info":{"selector":"body","frame":"","is_optional":"no","interval":"","js_code":"// show hidden select [davidkulcsar19] 2019-10-07\r\n$(\"select\").show();","timeout":"","comment":"","options":null,"checked":null}},{"type":2,"info":{"tagName":"SELECT","value":"credit_card_visa_amex_mc_discover","name":"","type":"select-one","id":"cart_paymentInstrument_displayId","title":"","options":[{"text":"Credit card or debit card","value":"credit_card_visa_amex_mc_discover"},{"text":"PayPal","value":"ewallet_paypal"},{"text":"Dell Preferred Account","value":"finance_leasing_dell_preferred_account"}],"selector":"#pidlddc-div-displayId select#cart_paymentInstrument_displayId","is_optional":"no","frame":"","timeout":"","text_only":"","comment":"","checked":null},"text":"Credit card or debit cardPayPalDell Preferred Account","field_key":"payment_method","field_type":"hardcode"},{"type":20,"info":{"tagName":"BUTTON","value":"Select","name":"","type":"button","id":"pidlddc-button-selectButtonPidlPayload","title":"","options":null,"selector":"#pidlddc-div-pagesubmitblock-div button#pidlddc-button-selectButtonPidlPayload","is_optional":"no","frame":"","timeout":"","comment":"","checked":null},"x":157,"y":645,"text":"Select"},{"type":2,"info":{"tagName":"INPUT","value":"David Kulcsar","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_accountHolderName","title":"","options":null,"selector":"#pidlddc-div-accountHolderName input#cart_paymentInstrument_accountHolderName","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"card_name","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"5300728933846307","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_accountToken","title":"","options":null,"selector":"#pidlddc-div-accountToken input#cart_paymentInstrument_accountToken","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"card_number","field_type":""},{"type":1001,"info":{"selector":"body","frame":"","is_optional":"no","interval":"","js_code":"// created by [davidkulcsar19] 2019-10-04\r\n$(\"select\").show();","timeout":"","comment":"","options":null,"checked":null}},{"type":2,"info":{"tagName":"SELECT","value":"3","name":"","type":"select-one","id":"cart_paymentInstrument_expiryMonth","title":"","options":[{"text":"01","value":"1"},{"text":"02","value":"2"},{"text":"03","value":"3"},{"text":"04","value":"4"},{"text":"05","value":"5"},{"text":"06","value":"6"},{"text":"07","value":"7"},{"text":"08","value":"8"},{"text":"09","value":"9"},{"text":"10","value":"10"},{"text":"11","value":"11"},{"text":"12","value":"12"}],"selector":"#pidlddc-div-expiryMonth select#cart_paymentInstrument_expiryMonth","is_optional":"no","frame":"","timeout":"","text_only":"","comment":"","checked":null},"text":"010203040506070809101112","field_key":"expiry_date_month","field_type":""},{"type":2,"info":{"tagName":"SELECT","value":"2022","name":"","type":"select-one","id":"cart_paymentInstrument_expiryYear","title":"","options":[{"text":"20","value":"2020"},{"text":"21","value":"2021"},{"text":"22","value":"2022"},{"text":"23","value":"2023"},{"text":"24","value":"2024"},{"text":"25","value":"2025"},{"text":"26","value":"2026"},{"text":"27","value":"2027"},{"text":"28","value":"2028"},{"text":"29","value":"2029"},{"text":"30","value":"2030"},{"text":"31","value":"2031"},{"text":"32","value":"2032"},{"text":"33","value":"2033"},{"text":"34","value":"2034"},{"text":"35","value":"2035"},{"text":"36","value":"2036"},{"text":"37","value":"2037"},{"text":"38","value":"2038"},{"text":"39","value":"2039"},{"text":"40","value":"2040"},{"text":"41","value":"2041"},{"text":"42","value":"2042"},{"text":"43","value":"2043"}],"selector":"#pidlddc-div-expiryYear select#cart_paymentInstrument_expiryYear","is_optional":"no","frame":"","timeout":"","text_only":"","comment":"","checked":null},"text":"19202122232425262728293031323334353637383940414243","field_key":"expiry_date_year","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"569","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_cvvToken","title":"","options":null,"selector":"#pidlddc-div-cvvToken input#cart_paymentInstrument_cvvToken","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"cvv","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"on","checked":false,"name":"","type":"checkbox","src":"","id":"pidlddc-prefillcontrol-description_type_addresstype_billingoperation_addcountry_us","title":"","options":null,"label":"Use shipping address for billing","selector":"#pidlddc-div-prefillAddressCheckbox input#pidlddc-prefillcontrol-description_type_addresstype_billingoperation_addcountry_us","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"same_billing","field_type":"hardcode"},{"type":2,"info":{"tagName":"INPUT","value":"416","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_address_line1","title":"","options":null,"selector":"[id='pidlddc-div-address_line1'] input[id='cart_paymentInstrument_address_line1']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"billing_address","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"Pratt l","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_address_line2","title":"","options":null,"selector":"[id='pidlddc-div-address_line2'] input[id='cart_paymentInstrument_address_line2']","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"billing_address_2","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"palo alt","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_city","title":"","options":null,"selector":"#pidlddc-div-city input#cart_paymentInstrument_city","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"billing_city","field_type":""},{"type":2,"info":{"tagName":"SELECT","value":"co","name":"","type":"select-one","id":"cart_paymentInstrument_region","title":"","options":[{"text":"Alabama","value":"al"},{"text":"Alaska","value":"ak"},{"text":"Arizona","value":"az"},{"text":"Arkansas","value":"ar"},{"text":"Armed Forces Africa","value":"ae"},{"text":"Armed Forces America","value":"aa"},{"text":"Armed Forces Pacific","value":"ap"},{"text":"California","value":"ca"},{"text":"Colorado","value":"co"},{"text":"Connecticut","value":"ct"},{"text":"Delaware","value":"de"},{"text":"Florida","value":"fl"},{"text":"Georgia","value":"ga"},{"text":"Hawaii","value":"hi"},{"text":"Idaho","value":"id"},{"text":"Illinois","value":"il"},{"text":"Indiana","value":"in"},{"text":"Iowa","value":"ia"},{"text":"Kansas","value":"ks"},{"text":"Kentucky","value":"ky"},{"text":"Louisiana","value":"la"},{"text":"Maine","value":"me"},{"text":"Maryland","value":"md"},{"text":"Massachusetts","value":"ma"},{"text":"Michigan","value":"mi"},{"text":"Minnesota","value":"mn"},{"text":"Mississippi","value":"ms"},{"text":"Missouri","value":"mo"},{"text":"Montana","value":"mt"},{"text":"Nebraska","value":"ne"},{"text":"Nevada","value":"nv"},{"text":"New Hampshire","value":"nh"},{"text":"New Jersey","value":"nj"},{"text":"New Mexico","value":"nm"},{"text":"New York","value":"ny"},{"text":"North Carolina","value":"nc"},{"text":"North Dakota","value":"nd"},{"text":"Ohio","value":"oh"},{"text":"Oklahoma","value":"ok"},{"text":"Oregon","value":"or"},{"text":"Pennsylvania","value":"pa"},{"text":"Puerto Rico","value":"pr"},{"text":"Rhode Island","value":"ri"},{"text":"South Carolina","value":"sc"},{"text":"South Dakota","value":"sd"},{"text":"Tennessee","value":"tn"},{"text":"Texas","value":"tx"},{"text":"Utah","value":"ut"},{"text":"Vermont","value":"vt"},{"text":"Virginia","value":"va"},{"text":"Washington","value":"wa"},{"text":"Washington D.C.","value":"dc"},{"text":"West Virginia","value":"wv"},{"text":"Wisconsin","value":"wi"},{"text":"Wyoming","value":"wy"}],"selector":"#pidlddc-div-region select#cart_paymentInstrument_region","is_optional":"no","frame":"","timeout":"","text_only":"","comment":"","checked":null},"text":"AlabamaAlaskaArizonaArkansasArmed Forces AfricaArmed Forces AmericaArmed Forces PacificCaliforniaColoradoConnecticutDelawareFloridaGeorgiaHawaiiIdahoIllinoisIndianaIowaKansasKentuckyLouisianaMaineMarylandMassachusettsMichiganMinnesotaMississippiMissouriMontanaNebraskaNevadaNew HampshireNew JerseyNew MexicoNew YorkNorth CarolinaNorth DakotaOhioOklahomaOregonPennsylvaniaPuerto RicoRhode IslandSouth CarolinaSouth DakotaTennesseeTexasUtahVermontVirginiaWashingtonWashington D.C.West VirginiaWisconsinWyoming","field_key":"billing_state","field_type":""},{"type":2,"info":{"tagName":"INPUT","value":"94306","checked":null,"name":"","type":"text","src":"","id":"cart_paymentInstrument_postal_code","title":"","options":null,"selector":"#pidlddc-div-postal_code input#cart_paymentInstrument_postal_code","is_optional":"no","frame":"","timeout":"","comment":""},"text":"","field_key":"billing_zip","field_type":""},{"type":20,"info":{"tagName":"BUTTON","value":"Save","name":"","type":"button","id":"pidlddc-button-saveButton","title":"","options":null,"selector":"#pidlddc-div-pagesubmitblock-div button#pidlddc-button-saveButton","is_optional":"no","frame":"","timeout":"","comment":"","checked":null},"x":269,"y":1905,"text":"Save"},{"type":2,"info":{"tagName":"INPUT","value":"on","checked":false,"name":"","type":"checkbox","src":"","id":"contactPreference","title":"","options":null,"label":"I want to receive email from Microsoft about exclusive offers, products, services, and events","selector":"input#contactPreference","is_optional":"no","frame":"","timeout":"","comment":"","has_custom_selector":true},"text":"","field_key":"newsletter","field_type":"hardcode"},{"type":20,"info":{"selector":"button.cli-purchase","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","comment":"","options":null,"checked":null}}],"currency_format":"$AMOUNT","recording_start_urls":{"authCheckout":"https://www.microsoft.com/en-us/store/cart","login":"https://login.live.com/login.srf?wa=wsignin1.0&rpsnv=13&rver=7.1.6819.0&wp=MBI_SSL&wreply=https%3a%2f%2fwww.microsoft.com%2fen-us%2fstore%2fcart&lc=1033&id=74335","authRemoveAddresses":"https://account.microsoft.com/billing/addresses#/","authRemovePayments":"","addToCart":"https://www.microsoft.com/en-us/d/surface-pro-keyboard-with-pen-storage/8xwb5zsck7pz/2DCV"},"recording_end_urls":{"addToCart":"https://www.microsoft.com/en-us/p/surface-headphones/8nrm8dz2zw43/8pzs?activetab=pivot:overviewtab&atc=true","authCheckout":"https://www.microsoft.com/en-US/store/buy/checkout","authRemoveAddresses":"https://account.microsoft.com/billing/payments?refd=account.microsoft.com","authRemovePayments":"https://account.microsoft.com/billing/payments?refd=account.microsoft.com#/?state=removeDone&piid=M9idgQAAAAABAACA","removeFromCart":"https://www.microsoft.com/en-us/store/cart"},"category_wrapper_div":null,"address_check_auth":null,"final_sale_div":null,"original_price_div":{"selector":"html[lang=\"en-US\"] body:not(:has(div.ttDEPrice)) #previousPrice:contains(\"$\"), body:not(:has(div.ttDEPrice)) div[id*=\"ProductPrice_productPrice_PriceContainer\"], div#ttDEOGPrice, body:not(:has(li[class*=\"active\"][class*=\"hero-content\"])) .priceCTA:not(:has(.priceCTA)) .price-msrp *[style*=\"line-through\"], [class*=\"active\"][class*=\"hero-content\"] .price-msrp *[style*=\"line-through\"], body:not(:has(.price-msrp)) .priceCTA:not(:has(.priceCTA)) span:contains(\"$\")[style*=\"line-through\"]:first","has_custom_selector":true},"discounted_price_div":{"selector":"//body[not(.//div[contains(@class,\"ttDEPrice\")])]//span[@id=\"currentPrice\"]|//div[contains(@id,\"ttDEDisPrice\")]|//body[not(.//li[contains(@class,\"active\") and contains(@class,\"hero-content\")])]//*[contains(@class,\"priceCTA\")]//*[contains(@class,\"price-msrp\")]//*[contains(@style,\"line-through\")]/../text()|//li[contains(@class,\"active\") and contains(@class,\"hero-content\")]//*[contains(@class,\"price-msrp\")]//*[contains(@style,\"line-through\")]/../text()|//body[not(.//*[contains(@class,\"price-msrp\")])]//*[contains(@class,\"priceCTA\")][not(.//*[contains(@class,\"priceCTA\")])]//span[contains(text(),\"$\")]","has_custom_selector":true},"sales_tax_div_auth":{"tagName":"SPAN","id":"ember1224","title":"","options":[],"selector":"#order-subtotal-tax-gst .ember-view","url":"https://www.microsoft.com/en-US/store/buy/checkout","recording_idx":"46","frame":""},"shipping_estimate_div_auth":{"selector":"div.cli-ship-method div","has_custom_selector":true,"recording_idx":"27","frame":""},"pickup_div":null,"non_purchasable_div":{"selector":"//button[contains(text(), \"Buy and download\")] | //a/span[contains(text(), \"Buy and download\")] | //h1[@id=\"DynamicHeading_productTitle\"][contains(text(), \"Office Home & Student\")] | //div[@id=\"tt365\"] | //body[@ttblock=\"block\"] | //a[contains(@class,'button')][contains(@aria-label,'Renew')] | //button[contains(text(), \"Kaufen und herunterladen\")] | //a/span[contains(text(), \"Kaufen und herunterladen\")]","has_custom_selector":true},"p_free_shipping_div":{"selector":"#BuyBoxMessages_systemMessages_ShippingMessage div","has_custom_selector":true},"errors_meta":[],"data_converters":{"shipping_address":[{"type":"simple","converter_id":"no_conversion"}],"shipping_city":[{"type":"simple","converter_id":"no_conversion"}],"shipping_state":[{"type":"simple","converter_id":"51ebf9e755a0f90acc00000c"}],"shipping_zip":[{"type":"simple","converter_id":"no_conversion"}],"shipping_telephone":[{"type":"simple","converter_id":"no_conversion"}],"card_number":[{"type":"simple","converter_id":"no_conversion"}],"expiry_date_month":[{"type":"simple","converter_id":"51ebf78555a0f90acc000007"}],"expiry_date_year":[{"type":"simple","converter_id":"51ebf8dc55a0f90acc00000a"}],"billing_address":[{"type":"simple","converter_id":"no_conversion"}],"billing_city":[{"type":"simple","converter_id":"no_conversion"}],"billing_state":[{"type":"simple","converter_id":"51ebf9e755a0f90acc00000c"}],"billing_zip":[{"type":"simple","converter_id":"no_conversion"}]},"logo":null,"delays":{"add_to_cart":10000,"product_opts_field":1000,"product_opts":297000,"add_to_cart_field_press":2000},"user_agent":"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0Safari/537.36 Honey_for_Microsoft/1.0","user_agent_scope":["cart","purchase"],"needed_banned_remote_urls":[],"contact":"https://support.microsoft.com/en-us/help/28808/microsoft-store-contact-support","ship_est_start_time":{"$date":"2019-10-13T14:18:15.874Z"},"est_stats_start_time":null,"checkout_information_auth":null,"regression_tests_status":{"daily_noauth_simple_test":{"at":{"$date":"2020-07-10T10:10:30.916Z"},"status":"ok","issues":null,"cart_failures":0,"purchase_failures":0,"estimation_failures":0},"local_success_test":{"at":{"$date":"2019-10-21T14:07:24.240Z"},"status":"ok","issues":null,"cart_failures":0,"purchase_failures":0,"estimation_failures":0},"feed_test":{"at":{"$date":"2021-05-26T00:13:24.169Z"},"status":"ok","issues":null,"cart_failures":0,"purchase_failures":0,"estimation_failures":0},"noauth_success_test":{"at":{"$date":"2019-12-04T12:41:42.531Z"},"status":"ok","issues":null,"cart_failures":0,"purchase_failures":0,"estimation_failures":0},"auth_success_test":{"at":{"$date":"2020-03-31T22:10:02.904Z"},"status":"failed","issues":["Purchase failed before confirm with an unknown error."],"cart_failures":3}},"checkout_dep_fields":null,"regression_products":[{"url":"https://www.microsoft.com/en-us/p/surface-arc-mouse/8MRMSZC6VXKC/KGWR","source":"manual"},{"url":"https://www.microsoft.com/en-us/p/xbox-wireless-controller/8XN59CRBSQGZ/RN43","source":"manual"},{"url":"https://www.microsoft.com/en-us/p/controller-gear-universal-xbox-pro-ladestation-robot-white/8pd7fxkhp5rw?cid=msft_web_collection","source":"manual"},{"url":"https://www.microsoft.com/en-us/store/configure/surface-duo/8p98gbqkdzl5/4tvl?atc=true","source":"manual"},{"url":"https://www.microsoft.com/en-us/p/kingston-hyperx-cloudx-stinger-core-gaming-headset-for-xbox-one/8v5n5w7rqtt7?atc=true","source":"manual"},{"url":"https://www.xbox.com/en-US/accessories/controllers/xbox-wireless-controller","source":"manual"},{"url":"https://www.xbox.com/en-us/accessories/mobile-gaming/moga-xp5-x","source":"manual"},{"url":"https://www.xbox.com/en-US/accessories/controllers/xbox-adaptive-controller","source":"manual"}],"store_options":{"images_on_add_to_cart":null,"creates_store_account":null,"final_price_includes_gift_card":null,"overwrite_sales_tax":null,"sync_noauth_and_auth":null,"one_coupon_only":null,"honey_billing_address":null,"add_app_to_ua":null,"shoprunner_on_shipping_opts":null,"existing_account_emails_not_allowed":null,"retry_on_info_failures":null,"disable_product_quantity":false,"disable_daily_regressions":null,"disable_image_proxy":null,"continue_on_alerts":null,"noauth_ends_with_success":null,"auth_ends_with_success":null,"local_ends_with_success":null,"use_chrome":null,"is_variantless":null},"product_opts_retrieval_js":"//create hidden element [David] 2019-10-04\r\n$('div#ttHidden').remove();\r\n\r\n// blocking xbox.com products that do not have a functional add to cart button, ex: are not yet available\r\n// -- https://www.xbox.com/en-us/accessories/controllers/daystrike-camo-special-edition -- available may 4 2021\r\nvar hasAddToCart = __utils__.findOne('[class*=\"purchRow\"] a[href*=\"http\"][aria-label*=\"cart\"]');\r\nvar isXboxProductPage = location.href.match(/xbox\\.com\\/en-[Uu][Ss]\\/accessories\\/[\\w-]+\\//);\r\nif(isXboxProductPage && !hasAddToCart) {\r\n  __utils__.echo('BLOCKING PRODUCT: product not available');\r\n  __utils__.echo('escapeVim');\r\n  return false;\r\n}\r\n\r\n// blocking french language products for microsoft canada\r\n// -- https://www.microsoft.com/fr-ca/microsoft-365/p/microsoft-365-personnel/cfq7ttc0k5bf?activetab=pivot%3aoverviewtab\r\nvar hasFrenchPrice = __utils__.findOne(_t_productPageSelectors.price) && __utils__.findOne(_t_productPageSelectors.price).text().match(/,\\d{2}(?:\\s|$)/);\r\nif (hasFrenchPrice || location.href.match(/\\/fr-[Cc][Aa]\\//)) {\r\n  __utils__.echo('BLOCKING PRODUCT: product not english');\r\n  __utils__.echo('escapeVim');\r\n  return false;\r\n}\r\n\r\n//blocking products that have a free price\r\n// -- https://www.microsoft.com/en-us/p/shark-world-game/9NJ4392FT99Z#activetab=pivot:overviewtab\r\nvar hasFreePrice = __utils__.findOne(_t_productPageSelectors.price) && __utils__.findOne(_t_productPageSelectors.price).text().match(/Free/);\r\nif(hasFreePrice) {\r\n  __utils__.echo('BLOCKING PRODUCT: product is free');\r\n  __utils__.echo('escapeVim');\r\n}\r\n\r\n// function to check if product is oos in add/remove from cart\r\n// -- https://www.microsoft.com/en-us/p/grounded-max-dino-tee/905G9Q7S3RJ6/HL52?atc=true -- XL size 04-12-2021\r\n_ttOOS = function() {\r\n  var isOOS = __utils__.findOne('//div[contains(@id,\"purchaseRegion\")]//button[contains(@id,\"OutOfStock\")]');\r\n  return Boolean(isOOS);\r\n};\r\n\r\n$(\"body\").append(\"<div id='ttHidden' style='display:none'></div>\");\r\n\r\n// customId helper function to get customId from URL schema\r\nfunction findCustomIdInUrl(regex, url) {\r\n  if(url && url.match(regex)) {\r\n    __utils__.echo('match found in: ' + regex);\r\n    return url.match(regex)[1];\r\n  }\r\n}\r\n\r\n// injecting customId\r\n// covering the various URL schemas THESE NEED TO COVER SYNCED RECIPE URLS AS WELL ex: microsoft CA both french and english\r\n// Office 365 products have no productId so we use title-slug instead\r\n// -- https://www.microsoft.com/en-us/microsoft-365/business/microsoft-365-apps-for-business?activetab=pivot:overviewtab\r\nvar ms365BusinessRegex = /.*microsoft\\.com\\/[Ee][Nn]-[UuCc][SsAa]\\/microsoft-365\\/(?:p|buy|business)\\/([^/?]*).*/;\r\nvar ms365Regex = /.*microsoft\\.com\\/[Ee][Nn]-[UuCc][SsAa]\\/microsoft-365\\/([^?&]*).*/;\r\n\r\n// the following URL schema has productId in the URL\r\n// -- https://www.microsoft.com/en-us/store/configure/Asus-ROG-Strix-GL10DH-Gaming-Desktop-PC/8VVBZF3PG624?atc=true&crosssellid=pcgaminglaptopinterstitial&preview=&previewModes=&selectedColor=\r\nvar mainProductIdRegex = /.*microsoft\\.com\\/[Ee][Nn]-[UuCc][SsAa]\\/(?:store\\/configure|p|store\\/d|d)\\/[^/]*\\/([^/?%#]+)[/?#&]?.*/;\r\n\r\n\r\n// xbox.com products have customId as productId in data-bi-product attr on their add to cart button:\r\n// -- https://www.xbox.com/en-us/accessories/mobile-gaming/moga-xp5-x \r\nvar xboxProductIdRegex = /.*microsoft\\.com\\/.*store\\/buy.*pid=(\\w+)&/;\r\nvar xboxProductUrl =  __utils__.findOne('[class*=\"purchRow\"] a[href*=\"http\"][aria-label*=\"cart\"]') && __utils__.findOne('[class*=\"purchRow\"] a[href*=\"http\"][aria-label*=\"cart\"]').attr('href');\r\n\r\n// test each URL schema, if nothing matches set ttCid to empty string\r\nvar ttCid = (findCustomIdInUrl(ms365BusinessRegex, location.href) || findCustomIdInUrl(ms365Regex, location.href) || findCustomIdInUrl(mainProductIdRegex, location.href) || findCustomIdInUrl(xboxProductIdRegex, xboxProductUrl) || '').toUpperCase();\r\n\r\n// some digital products match multiple regexes and so would not return title-slug as CID, therefore we check for the digital product prefix and set to title-slug\r\n// -- https://www.microsoft.com/en-us/p/xbox-game-pass-ultimate/cfq7ttc0khs0?WT.mc_id=CNavGamesXboxGamePassUltimate&activetab=pivot%3aoverviewtab\r\nvar digitalProductTitleSlug = /.*microsoft\\.com\\/[Ee][Nn]-[UuCc][SsAa]\\/(?:store\\/configure|p|store\\/d|d)\\/([^/?]*).*/;\r\nif (ttCid.match(/CFQ7TTC0/)) {\r\n    ttCid = (findCustomIdInUrl(digitalProductTitleSlug, location.href) || '').toUpperCase();\r\n  }\r\n\r\n$('#ttHidden').append('<div id=\"ttCid\" style=\"display: none;\">' + ttCid + '</div>');\r\n\r\n// handling starting at price\r\n// -- https://www.microsoft.com/en-us/store/configure/Surface-Book-3/8XBW9G3Z71F1?atc=true&crosssellid=fbt-p2c&preview=&previewModes=&selectedColor=\r\nvar subtotalSelectorText = __utils__.findOne('.subtotaltext:first') && __utils__.findOne('.subtotaltext:first').text();\r\nvar startingAtPriceRegex = /Starting\\sat.*[^\\d](\\d+[,.]\\d+)/i;\r\nif (subtotalSelectorText && subtotalSelectorText.match(startingAtPriceRegex)) {\r\n  var startingAtPrice = subtotalSelectorText.match(startingAtPriceRegex)[1];\r\n  $('#ttHidden').append('<div id=ttInitialPrice style=\"display:none;\">' + startingAtPrice + '</div>');\r\n}\r\n\r\n// is it a Microsoft 365 product page?\r\nvar verify365 = __utils__.findOne('//a[contains(@class, \"c-logo\")]/span[contains(text(), \"Microsoft 365\")]');\r\n\r\n//Gets background image from (some) Office 365 banners if the image url is only available within the style attribute\r\nif (verify365) {\r\n  var ttImage = __utils__.findOne('//header[contains(@class,\"c-category-header\")][//a[contains(@class, \"c-logo\")]/span[contains(text(), \"Microsoft 365\")]]//a[@id=\"uhfLogo\"]/img');\r\n  if (ttImage) {\r\n    var ttImageValue = ttImage.attr('src');\r\n    $(\"div#ttHidden\").append(\"<div id='ttImage'><img src='\" + ttImageValue + \"'></div>\");\r\n  }\r\n}\r\n\r\n//cloning description [David] 2019-10-04\r\nvar hasDescriptionSelectors = __utils__.findAll(_t_productPageSelectors['description']).length > 0;\r\nif (!hasDescriptionSelectors) {\r\n  $(\"div#ttHidden\").append(\"<div id='ttDescription'></div>\");\r\n  var descriptionDivs = __utils__.findAll(\"//section[@id='pivot-OverviewTab'] | //p[contains(@class,'pi-product-description-text')] | //body[not(//div[@id='purchaseRegion']//div[@id='skuSelector']//button[contains(@class,'c-action-trigger')] | //div[@id='purchaseRegion']//button[contains(@class,'pi-dropdown-trigger')])]//section[@id='pivot-TechSpecsTab']\");\r\n  $(descriptionDivs).toArray().forEach(function(el) {\r\n    $(el).clone().appendTo('div#ttDescription');\r\n  });\r\n  \r\n  //formating description [David] 2019-10-04\r\n  // https://www.microsoft.com/en-us/p/surface-headphones/8nrm8dz2zw43/8pzs\r\n  $(\"div#ttDescription div.video-container, div#ttDescription p#more-text, div#ttDescription a[href*='javascript'], div#ttDescription section.panel-overlay, div#ttDescription a[href*='pivot'], div#ttDescription div.cli_sku-variation.x-hidden\").remove();\r\n  \r\n  // https://www.microsoft.com/en-us/p/surface-pro-6-type-cover/8VVGCGKPSWS0/000Q\r\n  $(\"div#ttDescription li[id*='video'], div#ttDescription div.right-carousel, div#ttDescription div.left-carousel\").remove();\r\n  \r\n  // https://www.microsoft.com/en-us/p/surface-arc-mouse/8MRMSZC6VXKC/KGWR\r\n  $(\"div#ttDescription span.prv-btn-tooltip, div#ttDescription span.nxt-btn-tooltip, div#ttDescription li[id*='coreui-productplacement']\").remove();\r\n  $(\"div#ttDescription li a[aria-label*='show all']\").closest('li').remove();\r\n  \r\n  // https://www.microsoft.com/en-us/p/xbox-adaptive-controller/8NSDBHZ1N3D8/F2H9\r\n  $(\"div#ttDescription div.c-video-player\").remove();\r\n}\r\n\r\n// ***** Offers support for Microsoft 365 multi product page\r\n\r\n_365buildHidden = function (opt) {\r\n  if (!opt || opt === undefined || opt === null) {\r\n    return;\r\n  }\r\n  var _365title = __utils__.findOne(\"a#uhfCatLogo\");\r\n  if (_365title) {\r\n    _365title.addClass('ttcart');\r\n  }\r\n  $(\"div#ttHidden\").append(\"<div id='tt365'><div id='tt365price'></div></div>\");\r\n  $(\"div#ttDescription\").append(\"<p>Microsoft 365 products</p>\");\r\n\r\n  var el = opt; // now only single option, keeping the var el declaration just for consistency with how recipes are normally written\r\n  \r\n  // elText should be either \"For Home\" or \"For Business\" currently\r\n  // this is used as both the attribute text for the Category attribute as well as an identifier for the suboptions for each category (Business Basic, Business Standard, Personal, Family, etc)\r\n  var elText = el.attr('modname') && el.attr('modname').trim(); \r\n  var container = __utils__.findOne('//div[contains(@data-m, \"' + elText + '\")]');\r\n  var subOptsContainer = __utils__.findOne('//div[contains(@data-m, \"' + elText + '\")]//div[contains(@class, \"ow-products-row\")]');\r\n  \r\n  if (!subOptsContainer) { // https://www.microsoft.com/en-us/microsoft-365/buy/compare-all-microsoft-365-products\r\n    // Values that are normally on two separate elements for other 365 pages exist on the same element for the above mentioned page\r\n    subOptsContainer = __utils__.findOne('.compare-chart-table'); // Finding new subOptscontainer element\r\n    container = subOptsContainer;                                 // Assigning container variable to same element to ensure compatibility\r\n    if (!container) {\r\n      return;\r\n    }\r\n  }\r\n  \r\n  container.addClass('tt365');\r\n  \r\n  if (_365title) {\r\n    var tt365 = $(\"div#tt365\");\r\n    tt365.append('<div class=\"tt365category\" ttid=\"' + elText + '\" title=\"' + elText + '\"></div>');\r\n  }\r\n  \r\n  var subOpts = __utils__.findAll('div.ow-title-container, .row.header [prod-id]', subOptsContainer);\r\n  var altPriceDivs = __utils__.findAll('.price-value', subOptsContainer);\r\n  var altPriceTitles = __utils__.findAll('.comparechart-prodTitle', subOptsContainer);\r\n  for (var jPos = 0; jPos < subOpts.length; jPos ++) {\r\n    var subEl = subOpts[jPos];\r\n    var subElText = altPriceTitles && altPriceTitles[jPos] && altPriceTitles[jPos].text().trim() || subEl.text().trim();\r\n    var subElId = subEl.attr('prod-id') && subEl.attr('prod-id').trim();\r\n    var priceDiv = __utils__.findOne('//div[contains(@class, \"ow-price-cell\")][contains(@prod-id, \"' + subElId + '\")]//span[contains(@class, \"price-value\")]') || altPriceDivs[jPos];\r\n    var subElPrice = priceDiv && priceDiv.text().trim();\r\n    //[Joshua Bracks 6/3/20]: The below if statement filters out 365 Family and 365 Personal products based off of their product ids. \r\n    // If we are able to integrate them at cart in the future, removing the if check, but keeping the $().append within should re-enable them.\r\n    if (subElId != \"CFQ7TTC0K5DM\" && subElId != \"CFQ7TTC0K5BF\") {\r\n      $(\"div[ttid='\" + elText + \"'\").append('<div class=\"tt365prod\" ttid=\"' + subElId + '\" price=\"' + subElPrice + '\">' + subElText + '</div>');\r\n    }\r\n    if (jPos === 0) {\r\n      $('div#tt365price').html(subElPrice);\r\n    }\r\n  }\r\n\r\n};\r\n\r\n\r\nif (verify365) {\r\n  var opts = __utils__.findOne('div[id*=\"CompareTabs\"] .CompareTabs');\r\n  if (opts) {\r\n    _365buildHidden(opts);\r\n  }\r\n}\r\n\r\n// Generic attributes surface\r\n// https://www.microsoft.com/en-us/store/configure/Surface-Go-2/8PT3S2VJMDR6?crosssellid=fbt-p1c&selectedColor=&preview=&previewModes=\r\n\r\n_ttAttrMark = function() {\r\n  var opts = '';\r\n  // https://www.microsoft.com/en-us/store/configure/Surface-Go-2/8PT3S2VJMDR6?crosssellid=fbt-p1c&selectedColor=&preview=&previewModes=\r\n  var optsOne = __utils__.findAll('//h4[following-sibling::div[@role=\"listbox\"]] | //h4[following-sibling::div[@data-key=\"filtercolor\"]]');\r\n  // https://www.microsoft.com/en-us/store/config/Surface-Book-2/8MCPZJJCC98C?crosssellid=surfacebook2interstitial&selectedColor=&preview=&previewModes=\r\n  var optsTwo = __utils__.findAll('//div[contains(@class, \"c-group\")]//h2[contains(@class, \"c-heading\")]');\r\n  // https://www.microsoft.com/en-us/store/configure/Surface-Book-3/8xbw9g3z71f1?crosssellid=&selectedColor=\r\n  var optsThree = __utils__.findAll('//div[contains(@id, \"drawerContainer\")]//div[contains(@role, \"heading\")]');\r\n  if (optsOne.length) {\r\n    opts = optsOne;\r\n  } else if (optsTwo.length) {\r\n    opts = optsTwo;\r\n  } else if (optsThree.length) {\r\n    opts = optsThree;\r\n  }\r\n\r\n  var idx = 0;\r\n  for (var iPos = 0; iPos < opts.length; iPos++) {\r\n    idx++;\r\n    if (idx > 5) {\r\n      $(\"body\").attr('ttblock', 'block');\r\n    }\r\n    var el = opts[iPos];\r\n    var elTitle = __utils__.findOne('span', el) && __utils__.findOne('span', el).text().trim() || el.text().trim();\r\n    el.attr(\"ttgetter\", idx);\r\n    var elContainer = __utils__.findOne('//h4[@ttgetter=\"' + idx + '\"]/following-sibling::div[@role=\"listbox\"] | //h4[@ttgetter=\"' + idx + '\"]/following-sibling::div[@data-key=\"filtercolor\"]');\r\n    if (!elContainer) {\r\n      elContainer = __utils__.findOne('//h2[@ttgetter=\"' + idx + '\"]/../following-sibling::div[contains(@class, \"c-group\")] | //h2[@ttgetter=\"' + idx + '\"]/../following-sibling::div[contains(@class, \"color-swatches\")]');\r\n    } if (!elContainer) {\r\n      elContainer = __utils__.findOne('//div[contains(@id, \"drawerContainer\")]//div[contains(@role, \"heading\") and contains(@ttgetter, \"' + idx + '\")]/following-sibling::div[@role=\"listbox\"] | //div[contains(@id, \"drawerContainer\")]//div[contains(@role, \"heading\") and contains(@ttgetter, \"' + idx + '\")]/following-sibling::div[@class=\"fc-color-picker\"]');\r\n    }\r\n    if (elContainer) {\r\n      elContainer.attr('tttitle', elTitle);\r\n      elContainer.attr('ttmark', idx);\r\n    }\r\n    $('body').attr('ttmark' + idx, 'true');\r\n  }\r\n};\r\n\r\n_ttAttrMark();\r\n\r\n_ttGetText = function(el) {\r\n  var elText = __utils__.findOne('//h6', el) && __utils__.findOne('//h6', el).before(el[0]) && __utils__.findOne('//h6', el).before(el[0]).text().trim();\r\n  // https://www.microsoft.com/en-us/store/configure/Surface-Book-3/8xbw9g3z71f1?crosssellid=&selectedColor=\r\n  if (!elText) { // one with span\r\n    var elTextEl = __utils__.findOne(\"span.c-heading-6\", el);\r\n    elText = elTextEl && elTextEl.text().trim();\r\n  }\r\n  // https://www.microsoft.com/en-us/store/configure/Surface-Laptop-4/946627fb12t1?crosssellid=&selectedColor=9A9CA3\r\n  if (!elText) {\r\n    var elTextEl = __utils__.findOne(\".color-picker-label\", el);\r\n    elText = elTextEl && elTextEl.text().trim();\r\n  }\r\n  var data = el.data();\r\n  if (!elText && data) {\r\n    elText = data.prdname;\r\n  }\r\n  if (!elText && data) {\r\n    elText = data.item && data.item.text;\r\n  }\r\n  if (!elText) {\r\n    elText = el.attr('data-item-text');\r\n  }\r\n  var data = el.attr('data-m');\r\n  if (!elText && el.closest('div[role=listbox]') && el.closest('div[role=listbox]').attr('aria-labelledby') && el.closest('div[role=listbox]').attr('aria-labelledby') == \"filtercolor\"){\r\n    elText = el.attr('aria-label') && el.attr('aria-label').trim();\r\n  }\r\n  if (!elText) {\r\n    elText = __utils__.findOne(\"//h6\", el) && __utils__.findOne(\"//h6\", el).text().trim() || el.text().trim();\r\n  }\r\n  if (!elText) {\r\n    elText = __utils__.findOne('//h6', el) && __utils__.findOne('//h6', el).before(el[0]).text().trim();\r\n  }\r\n  if (!elText) {\r\n    elText = __utils__.findOne('//h6', el) && __utils__.findOne('//h6', el).after(el[0]).text().trim();\r\n  }\r\n  // the below data almost always matches, so we would want to double check it as much as possible\r\n  data = el.data();\r\n  if (!elText && data) {\r\n    elText = data.m && data.m.cN;\r\n  }\r\n  return elText;\r\n};\r\n\r\n// Handling German price formatting [Zach B. 10/13/20]\r\n_ttDEPrice = function() {\r\n  // These 3 variables are comprised of the original selectors in each price field, before any updates were made to handle the german price format\r\n  // 'div.ordersummary span:contains(\"Zwischensumme\")+' is the only selector added, I added to the original group. \r\n  // It's the last selector in ttPrice, and it is just the german language analog of 'div.ordersummary span:contains(\"Subtotal\")+'\r\n  var ttPrice = __utils__.findOne('div#ProductPrice_productPrice_PriceContainer, div.m-product-detail-hero-product-placement div.price-info span, div.ow-price-text:not(#owPriceText) div.ow-price-text span, body:not(:has(div.ow-price-text:not(#owPriceText) div.ow-price-text span)) #owPriceText, #tt365price, div#PageBarModuleHeaderArea div.total-price span.list-price, div.ordersummary span:contains(\"Subtotal\")+, div.ordersummary span:contains(\"Zwischensumme\")+');\r\n  var ttOGPrice = __utils__.findOne('div#ProductPrice_productPrice_PriceContainer s');\r\n  var ttDisPrice = __utils__.findOne('div#ProductPrice_productPrice_PriceContainer span.price-disclaimer');\r\n  // €, $\r\n  // ttCheckDE is True if and only if we find a price with the '€' symbol in it\r\n  var ttPriceText = ttPrice && ttPrice.text().trim();\r\n  var ttOGPriceText = ttOGPrice && ttOGPrice.text().trim();\r\n  var ttDisPriceText = ttDisPrice && ttDisPrice.text().trim();\r\n  var ttCheckDE = (ttPriceText && ttPriceText.indexOf('€') != -1 || ttDisPriceText && ttDisPriceText.indexOf('€') != -1 && ttOGPriceText && ttOGPriceText.indexOf('€') != -1);\r\n\r\n  if(ttCheckDE) {\r\n    // removing any pre-existing ttDEPrices\r\n    var ttPrices = __utils__.findAll('div.ttDEPrice');\r\n    ttPrices.forEach(function(el) {\r\n      el.remove();\r\n    });\r\n    // Checking for a discounted price first since the OG price selectors are a subset of normal price selectors, so we don't worry about updating ttDENPrice\r\n    // and confuse TT more than necessary.\r\n    // €\r\n    if (ttDisPriceText && ttDisPriceText.indexOf('€') != -1) {\r\n      var ttDEDisPrice = ttDisPriceText.replace(/\\./g, '');\r\n      ttDEDisPrice = ttDEDisPrice.replace(',', '.');\r\n      var ttDEOGPrice = ttOGPriceText.replace(/\\./g, '');\r\n      ttDEOGPrice = ttDEOGPrice.replace(',', '.');\r\n      __utils__.echo('discount and originonal prices after re-formatting: ' + ttDEDisPrice + ', ' + ttDEOGPrice);\r\n      __utils__.findOne('div#ttHidden').append('<div id=\"ttDEDisPrice\" class=\"ttDEPrice\">' + ttDEDisPrice + '</div>');\r\n      __utils__.findOne('div#ttHidden').append('<div id=\"ttDEOGPrice\" class=\"ttDEPrice\">' + ttDEOGPrice + '</div>');\r\n    } else {\r\n      var ttDENPrice = ttPriceText.replace(/\\./g, '');\r\n      ttDENPrice = ttDENPrice.replace(',', '.');\r\n      __utils__.echo('normal price after re-formatting: ' + ttDENPrice);\r\n      __utils__.findOne('div#ttHidden').append('<div id=\"ttDENPrice\" class=\"ttDEPrice\">' + ttDENPrice + '</div>');\r\n    }\r\n  }\r\n};\r\n_ttDEPrice();\r\n\r\n_ttAttrGet = function(idx){\r\n    var result = [];\r\n    var container = __utils__.findOne(\"//*[@ttmark=\" + idx +\"]\");\r\n    var title = container && container.attr('tttitle');\r\n    // clean title of illegal keywords such as \"select your\" or \"choose your\"\r\n    title = title && title.replace(/.*your\\s|\\s\\(.+\\)/g, '').charAt(0).toUpperCase() + title.replace(/.*your\\s|\\s\\(.+\\)/g, '').substr(1);\r\n    var opts = __utils__.findAll(\"//button[@role='option'] | //button | //fieldset[contains(@class, 'color-picker')]//span//label\", container);\r\n    for (var iPos = 0; iPos < opts.length; iPos++) {\r\n        var el = opts[iPos];\r\n        var elText = _ttGetText(el);\r\n        if ((!el.attr('disabled') && elText) || (el.attr('disabled') != 'disabled') && elText) {\r\n          __utils__.echo(\"TITLE: \" + title);\r\n          __utils__.echo(\"TEXT: \" + elText);\r\n          var elValue = title + \": \" + elText;\r\n          elValue = elValue.trim();\r\n          result.push(elValue);\r\n        }\r\n    }\r\n    return result;\r\n};\r\n\r\n_ttAttrSet = function(fillValue, idx){\r\n  __utils__.echo(\"fillValue ----> \" + fillValue);\r\n  var changed = false;\r\n  var container = __utils__.findOne(\"//*[@ttmark=\" + idx +\"]\");\r\n  var title = container && container.attr('tttitle');\r\n  // clean title of illegal keywords such as \"select your\" or \"choose your\"\r\n  title = title && title.replace(/.*your\\s|\\s\\(.+\\)/g, '').charAt(0).toUpperCase() + title.replace(/.*your\\s|\\s\\(.+\\)/g, '').substr(1);\r\n  var opts = __utils__.findAll(\"//button[@role='option'] | //button | //fieldset[contains(@class, 'color-picker')]//span//label\", container);\r\n  for (var iPos = 0; iPos < opts.length; iPos++) {\r\n    var el = opts[iPos];\r\n    var elText = _ttGetText(el);\r\n    var elValue = title + \": \" + elText;\r\n    __utils__.echo(\"elValue    ----> \" + elValue);\r\n    \r\n    if (elValue.trim() == fillValue) {\r\n      __utils__.echo(\"MATCH\");\r\n      __utils__.mouseEvent('click', el);\r\n      changed = true;\r\n      _updateSku();\r\n    }\r\n  }\r\n  // Have to call german price format function inside generic set [Zach B. 10/14/20]\r\n  _ttDEPrice();\r\n  return changed;\r\n};\r\n\r\n// Grabs titles from configurable pages and inserts them into a hidden div\r\n// https://www.microsoft.com/en-us/store/configure/Surface-Go-2/8PT3S2VJMDR6?crosssellid=fbt-p1c&selectedColor=&preview=&previewModes=\r\n_ttTitle = function(){\r\n  var configureRegex = /.*store\\/(?:configure|config)\\/([^/]+)\\/.*/;\r\n  var isConfigurable = configureRegex.exec(location.href);\r\n  if (isConfigurable && isConfigurable[1]) {\r\n    var title = isConfigurable[1].replace(/-/g, \" \").replace(/(^\\w|\\s\\w)/g, '$1');\r\n    // changing to titleCase\r\n    // split separates the words between spaces and pushes them into an array\r\n    var localStr = title.toLowerCase().split(' ');\r\n    for (var i = 0; i < localStr.length; i++) {\r\n      localStr[i] = localStr[i].charAt(0).toUpperCase() + localStr[i].slice(1); \r\n    }\r\n    // join rejoins the title into a full string\r\n    title = localStr.join(' ');\r\n    $('#ttHidden').append(\"<div id='ttTitle'>\" + title + \"</div>\");\r\n  }\r\n};\r\n\r\n_ttTitle();\r\n\r\n\r\n\r\n// Updating the SKU [Ata]\r\n_updateSku = function() {\r\n  $('.ttSku').remove();\r\n  sleep(1000);\r\n  var atcButton = __utils__.findOne('a.btn.btn-primary[aria-label], button.selected[data-m]');\r\n  var rawAtcObj = atcButton && atcButton.attr('data-m');\r\n  var atcObj;\r\n  try {\r\n    atcObj = JSON.parse(rawAtcObj);\r\n  } catch (e) {}\r\n  var sku = atcObj && atcObj[\"sku\"] || atcObj && atcObj[\"tags\"] && atcObj[\"tags\"][\"sku\"];\r\n  if (!sku) {\r\n    var altATC = __utils__.findOne('li[class*=\"active\"] div.accInfo a.addToCartBtn');\r\n    sku = altATC && altATC.attr('data-bi-sku');\r\n    if (!sku) {\r\n      var newATC = __utils__.findOne('li[class*=\"active\"] div.accInfo a.addToCartBtn');\r\n      var attrReg = /.*sid=([^&?%]+).*/;\r\n      var urlString = newATC && newATC.attr('href');\r\n      sku = attrReg.exec(urlString) && attrReg.exec(urlString)[1];\r\n    }\r\n  }\r\n  var skuFinal = sku ? (ttCid + '-' + sku) : ttCid;\r\n  __utils__.echo('THIS IS THE SKU: ' + skuFinal);\r\n  $('#ttHidden').append('<div class=\"ttSku\" style=\"display: none;\">' + skuFinal + '</div>');\r\n};\r\n_updateSku();\r\n\r\n// clicks on the view more button to get the full description\r\nvar viewMoreBtn = __utils__.findOne('button.show-more-show-less-toggle[aria-expanded=\"false\"]');\r\nif(viewMoreBtn){\r\n  __utils__.mouseEvent('click', viewMoreBtn);\r\n}","coupon_recording":null,"coupon_recording_info":null,"coupon_recording_error_div":null,"order_id_div_auth":null,"description_div":{"selector":"span[data-automation-test-id=\"buy-box-product-description\"], #buy-box-product-description","has_custom_selector":true},"returns":"<p><strong>Returning items you bought from Microsoft Store for exchange or refund</strong></p>\r\n\r\n<p>If you purchased a product from Microsoft or Microsoft Store, you can request a return. You&#39;ll then find out if your product is eligible for a return. If you purchased a product from another organization, contact that organization to request returns or refunds. You can check your Order history at [https://account.microsoft.com/billing/orders] to verify what you&#39;ve ordered from Microsoft.</p>\r\n\r\n<p><strong>Note</strong><br />\r\nIf you want to cancel a Microsoft subscription or free trial subscription, including Xbox Live and Office 365, see Cancel or turn off recurring billing on a Microsoft subscription at [https://support.microsoft.com/en-us/help/4027815]. If you see a charge after turning off recurring billing, you may have turned it off after the expiration date. Subscription recurrence dates and billing dates are different (learn more at [https://support.microsoft.com/en-us/help/10640]).</p>\r\n\r\n<p><strong>Returns and exchanges<br />\r\nYou can manage returns, exchanges, and more on the Order history page.&nbsp;</strong></p>\r\n\r\n<p><strong>To request a return or exchange:</strong></p>\r\n\r\n<p>1. Sign in to Order history at [https://account.microsoft.com/billing/orders], and then select Request a return. If you don&rsquo;t see Request a return, your item may not be eligible for a return. For detailed info about the return and refund policy, see Microsoft Terms of Sale [https://go.microsoft.com/fwlink/p/?linkid=839716].</p>\r\n\r\n<p><strong>Note</strong><br />\r\nItems that may be eligible for return, refund, or exchange include physical goods like a Surface, Xbox controller, virtual reality headset, or packaged software. Digital gift cards and service/subscription cards may also be eligible for return (see Microsoft gift card terms and conditions at [https://support.microsoft.com/en-us/help/10562]). Digital goods like apps, games, add-on content, subscriptions, movies, TV shows, and books aren&#39;t returnable unless the offer or applicable law states that you&#39;re eligible for a refund.</p>\r\n\r\n<p>2. Follow the instructions on the screen to get a prepaid shipping label for the return. If you can&#39;t get a prepaid shipping label for the return, contact support at [https://support.microsoft.com/contactus].<br />\r\n3. When we receive your item and find it eligible for a return, we&rsquo;ll either ship you a replacement or issue you a refund.</p>\r\n\r\n<p>You can see the status of your return or exchange on the Order history page at [https://account.microsoft.com/billing/orders] (learn more [https://support.microsoft.com/en-us/help/4026286]).</p>\r\n\r\n<p><strong>Refunds</strong></p>\r\n\r\n<p>When you make a qualifying return, we&#39;ll credit the full amount, less the original shipping and handling charges. Refunds are generally processed within 3&ndash;5 business days after we receive your item and find it eligible for a return. Refunds are applied to the original payment option.</p>\r\n\r\n<p>You can see the status of your refund on the Order history page at [https://account.microsoft.com/billing/orders] (learn more [https://support.microsoft.com/en-us/help/4026286]).</p>\r\n\r\n<p><strong>Unexpected or inaccurate charges</strong><br />\r\nTo address unexpected charges, first see What to do about unexpected charges from Microsoft [https://support.microsoft.com/en-us/help/10623]. If you don&#39;t see the cause for your unexpected charge, you can select the Contact us link at the top of the page, or you can contact Microsoft Store support [https://support.microsoft.com/en-us/help/28808.</p>\r\n\r\n<p><strong>More help</strong><br />\r\nSee the resources below for more help with Microsoft products and services.</p>\r\n\r\n<p>- Get info about how to prevent unauthorized purchases from Microsoft Store [https://support.microsoft.com/en-us/help/4028531.<br />\r\n- Learn how to cancel an order or pre-order from Microsoft Store [https://support.microsoft.com/en-us/help/4000642].<br />\r\n- See more topics related to Microsoft subscriptions at My subscriptions [https://support.microsoft.com/hub/4135076/microsoft-store-help#my-subscriptions].<br />\r\n- Visit Microsoft Support at [https://support.microsoft.com/] for help with products such as Windows 10, Xbox, Office, and more.</p>\r\n","final_price_div_local":null,"sales_tax_div_local":null,"order_id_div_local":null,"checkout_recording_local":null,"identifier_div_local":null,"name_div_local":null,"distance_div_local":null,"address_div_local":null,"phone_div_local":null,"when_div_local":null,"change_store_div_local":null,"wrapper_div_local":null,"coupon_value_div_auth":null,"gift_card_value_div_auth":null,"remove_addresses_recording_auth":[{"type":20,"info":{"selector":"a[aria-label='Delete address']","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","comment":"","options":null,"checked":null}},{"type":20,"info":{"selector":"button#ship-delete-confirm","frame":"","is_optional":"no","interval":"","js_code":null,"timeout":"","comment":"","options":null,"checked":null}}],"remove_baddresses_recording_auth":null,"remove_payments_recording_auth":[],"mobile_url_conversion":null,"allowed_product_url_args":["none"],"gift_card_recording":null,"gift_card_recording_info":null,"gift_card_recording_error_div":null,"gift_card_recording_continue_div":null,"remote_status_recording":null,"remote_status_container_div":null,"remote_status_title_div":null,"remote_status_state_div":null,"remote_status_tracking_div":null,"shipping_options_div":{"selector":"div.cli_ship-method-radio","has_custom_selector":true},"shipping_options":{"cheapest":{"text":"cheapest","min_days":"3","max_days":"7"}},"shipping_options_recording_info":{"auth_start_idx":"25"},"shipping_estimate_exceptions":{"cheapest":"","fastest":""},"sync_data":[],"sync_master_url":null,"shipping_address_div_auth":null,"proxy":{"cart":"","purchase":""},"estimator":"price","feed_type":"linkshare","feed_meta":{"origin":"24542","idx_source":"parsed_url","idx_transform":".*\\/([^\\-].+)\\/.* --> $1"},"grouping_identifiers":[{"field":"custom_id","modifier":""}],"platform":"default","platform_meta":null,"resolution":null,"cookies":null,"headers":null,"product_fetch_timeout":null,"tags":[],"login_url_check":null,"title_regexp":"\\s-\\s.+ --> || Digital\\sCode.+ --> Digital Code || \\s\\(.+$ -->","p_attr_regexp":null,"images_regexp":"\\?.* --> || (.*) --> $1?w=2000&h=2000","sku_regexp":"#.* -->","mpn_regexp":null,"gtin_regexp":null,"receipt_prices":"unknown","gifting_recording":null,"gifting_recording_info":null,"page_detector":[{"selector":["#store-cart-root button:contains('Place order')"],"type":"submit_order","regex":"","label":""},{"selector":["div[class *= \"ThankYouPage\"] > button[aria-label *= \"successfully purchased\"]"],"type":"checkout_confirm","regex":"xbox\\.com\\/en-us\\/games","label":"xbox games"},{"selector":["body:not(:has(span[class *= discountDetails])) div.ms-Stack:has(div:contains(\"purchasing:\")):first, div.line-item-row .line-item:contains(\"$\"), body:has(app-signup-collect-payment #payment-wrapper) div.signupContainer, #PurchaseWizardStepReviewOrder, div[class*='lineItemRow']:contains(\"$\") "],"type":"cart_product","regex":"(?:stores.office.com\\/subscription\\/acquire)|(?:microsoft.com\\/en-[uU]s\\/store\\/cart)","label":""},{"selector":["#SubscriptionSetupLink"],"type":"checkout_confirm","regex":"microsoft\\.com.*create-account.*signupCompleted=1","label":"Microsoft 365 Business checkout - signed out (new account creation)"},{"selector":["#PurchaseOrderCompletedPanel"],"type":"checkout_confirm","regex":"portal\\.office\\.com\\/Commerce\\/CompleteOrderSummary","label":"Microsoft 365 Business checkout - signed in"},{"selector":["div:has(> span:contains(order number)) > a"],"type":"checkout_confirm","regex":"microsoft\\.com\\/en-[Uu][Ss]\\/store\\/congrats","label":"Main checkout flow"},{"selector":[".contentbody span a[data-ow-addtocart]:visible, #store-cart-root, #order-help-order-id, .step.signupStepBottom.bottomSection, #page-title:contains(\"Xbox Live Gold\") + dl #productBuyButton, #purchaseDialogContentRoot, #DynamicHeading_productTitle:contains(\"Xbox Live Gold\"), iframe[title=\"Purchase Frame\"]:visible, iframe[name*=\"store-checkout\"][class*=\"CheckoutPage\"]:visible, #pills-tab:visible,#purchase-frame"],"type":"honey_gold","regex":".+\\/.*\\/(store\\/(cart|checkout|guest\\-checkout)|buy\\/(compare\\-all\\-microsoft)|(xbox\\-game\\-pass.*)|(games\\/store.*)|checkout)","label":"standard cart/checkout, compare all plans, xbox"},{"selector":["body:not(:has(.availableDate))"],"type":"product","regex":"xbox\\.com\\/en-[Uu][Ss]\\/accessories\\/[\\w-]+\\/","label":"xbox accessories"},{"selector":["body:has(meta[property=\"og:title\"]) [id*=OneStore-AccordionContainer] [id*=ProductConfiguratorDrawer], h4 + div[role=\"listbox\"], div[class*=\"c-group\"] h2[class*=\"c-heading\"], div#drawerContainer-0 div[role=\"heading\"]","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"product","regex":"microsoft\\.com\\/en-us\\/.*configure\\/.+?\\/\\w{12}","label":"Configurable Products"},{"selector":["html:not(:has(meta[content = \"compare-page-d\"])) body:not(:has(a[aria-label=\"Explore information for business.\"][status=active])) a#uhfCatLogo:contains(\"Microsoft 365\")","body:not(:has(a[class*='button'][aria-label*='Renew']))","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"product","regex":"\\/microsoft-365\\/(?:business|buy|p)\\/","label":"Microsoft 365"},{"selector":["div.container a.btn[aria-label='Add to cart'], #ButtonPanel_buttons button#buttons_AddToCartButton, button#buttonPanel_AddToCartButton, button#exp-WebbuttonPanelPre_AddToCartButton, div.ow-product-price div#owFirstPriceButton.ow-price-button a.c-button, div#buttonPanelPreAndPostVariation div.pi-overflow-ctrl button[aria-label=\"Buy and download\"], button[id*=\"buttons_AddToCartButton\"], #purchaseColumn button[aria-label=\"Buy\"], div.m-product-detail-hero-product-placement [id*=\"purchaseCTA\"] button.cli_pdp-buy-button, #rootContainer_BuyBox .buy-box-buy-buttons button[aria-label]","div.container .buybox h1, h1#DynamicHeading_productTitle, h1#page-title, h1.ow-prod-name","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"product","regex":"www\\.microsoft\\.com\\/en-[Uu][Ss].*\\/(?:business|p|d)\\/([^/]+|[^?])(?:\\/|\\?).*","label":"Product page"},{"selector":["html:not(:has(meta[content = \"compare-page-d\"])) body:not(:has(a[aria-label=\"Explore information for business.\"][status=active])) a#uhfCatLogo:contains(\"Microsoft 365\")","body:not(:has(a[class*='button'][aria-label*='Renew']))","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"where_am_i","regex":"\\/microsoft-365\\/(?:business|buy|p)\\/","label":"Microsoft 365"},{"selector":["body:has(meta[property=\"og:title\"]) [id*=OneStore-AccordionContainer] [id*=ProductConfiguratorDrawer], h4 + div[role=\"listbox\"], div[class*=\"c-group\"] h2[class*=\"c-heading\"], div#drawerContainer-0 div[role=\"heading\"]","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"where_am_i","regex":"microsoft\\.com\\/en-us\\/.*configure\\/.+?\\/\\w{12}","label":"Configurable Products"},{"selector":["div.container a.btn[aria-label='Add to cart'], #ButtonPanel_buttons button#buttons_AddToCartButton, button#buttonPanel_AddToCartButton, button#exp-WebbuttonPanelPre_AddToCartButton, div.ow-product-price div#owFirstPriceButton.ow-price-button a.c-button, div#buttonPanelPreAndPostVariation div.pi-overflow-ctrl button[aria-label=\"Buy and download\"], button[id*=\"buttons_AddToCartButton\"], #purchaseColumn button[aria-label=\"Buy\"], div.m-product-detail-hero-product-placement [id*=\"purchaseCTA\"] button.cli_pdp-buy-button, #rootContainer_BuyBox .buy-box-buy-buttons button[aria-label]","div.container .buybox h1, h1#DynamicHeading_productTitle, h1#page-title, h1.ow-prod-name","html[lang=\"en-us\"], html[lang=\"en-US\"]"],"type":"where_am_i","regex":"www\\.microsoft\\.com\\/en-[Uu][Ss].*\\/(?:business|p|d)\\/([^/]+|[^?])(?:\\/|\\?).*","label":"Product Page"},{"selector":["body:not(:has(.availableDate))"],"type":"where_am_i","regex":"xbox\\.com\\/en-[Uu][Ss]\\/accessories\\/[\\w-]+\\/","label":"Xbox Accessories"}],"page_detector_watch":true,"h_legacy_find_savings":{"h_fs_promo_box_selector":"","h_fs_final_price_selector":"#store-cart-root span:contains(\"Total*\") + span","h_fs_submit_button":"","h_fs_time_between_codes":"2500","h_fs_pre_apply_code_action":"","h_fs_time_between_pre_apply":"1000","h_fs_remove_code_action":"","h_fs_time_between_remove":"1000","h_fs_hide_cart_errors_selector":"","h_fs_hide_cart_errors_selector2":"","h_fs_time_finish":"2000","h_fs_max_codes":"10","h_format_price_divisor":"","h_existing_code_selector":"","h_existing_code_selector_regex":"","h_existing_code_selector_attribute":"","temp_disable_find_savings":false},"h_legacy_metadata":{"pns_siteID":"microsoftstore","pns_siteSelCartAddButton":"#promoCode","pns_siteSelCartAddButtonType":"append","pns_siteSelCartCodeSubmitType":"click","pns_siteType":"refresh","approved_by":"ryan","pns_observerTarget":"body","pns_siteSelShowHoneyGold":".contentbody span a[data-ow-addtocart]:visible, #store-cart-root, #order-help-order-id, .step.signupStepBottom.bottomSection, #page-title:contains(\"Xbox Live Gold\") + dl #productBuyButton, #purchaseDialogContentRoot, #DynamicHeading_productTitle:contains(\"Xbox Live Gold\"), iframe[title=\"Purchase Frame\"]:visible, iframe[name*=\"store-checkout\"][class*=\"CheckoutPage\"]:visible, #pills-tab:visible,#purchase-frame","pns_gDAChtmlRes":"","pns_gDACjsonContentType":"","honeyTipsAutopopOn":"true","pns_siteSelOrderId":"div:has(> span:contains(order number)) > a","droplist_universal_active":"true","iosHGEnabled":"true","submitOrderButton":"#store-cart-root button:contains('Place order')"},"mixins":null,"vim_overrides":null,"privacy_url":"https://privacy.microsoft.com/en-US/privacystatement","tos_url":"https://www.microsoft.com/en-us/legal/intellectualproperty/copyright/default.aspx","where_am_i":{"title_selector":"#uhfCatLogo:contains(365), div.context-menu h1[class*=c-heading]:first, html[lang=\"en-US\"] div.container .buybox h1 , h1#DynamicHeading_productTitle, body:not(:has(h1#DynamicHeading_productTitle)) div#titleGroupPageBar div div h1, h1#page-title, h1.ow-prod-name, *[id*=\"BlockList\"] *[class*=\"banner\"] h1:first","price_selector":"html[lang=\"en-US\"] div.buy-box-row:not(:has(.text-line-through)) [data-automation-test-id=\"buy-box-pricing\"], html[lang=\"en-US\"] #currentPrice, div[id*=\"ProductPrice_productPrice_PriceContainer\"], body:not(:has(div.ttDEPrice)):not(:has(#skuDropdownList:contains($))) div.m-product-detail-hero-product-placement div.price-info span, div.ow-price-text:not(#owPriceText) div.ow-price-text span, body:not(:has(div.ow-price-text:not(#owPriceText) div.ow-price-text span)) #owPriceText, div#PageBarModuleHeaderArea div.total-price span.list-price, body:not(:has(div.ttDEPrice)) div.ordersummary span:contains(\"Subtotal\")+, div#ImageCollectionCarousel div.expOrderSummaryInfo div.exp-default-selection div.exp-summary-col-2, div#ImageCollectionCarousel div.exp-summary-container div.expOrderSummaryInfo div.exp-lstprice, body:not(:has(div.ttDEPrice)) #headerArea .list-price, #skuDropdownList:contains($), body:not(:has(li[class*=\"active\"][class*=\"hero-content\"])) .priceCTA:not(:has(.priceCTA)) .price-msrp:first, [class*=\"active\"][class*=\"hero-content\"] .price-msrp, body:not(:has(.price-msrp)) .priceCTA:not(:has(.priceCTA)) span:contains(\"$\"):first","image_selector":"#image img, html[lang=\"en-US\"] #rootContainer_BuyBox div.buy-box-product-image picture img , div#productImage img, body:not(:has(#uhfCatLogo:contains('Microsoft 365'))) div.m-product-detail-hero-carousel li[id*='hero-slide'].f-active img, div#backgroundImage img, body:not(:has(#uhfCatLogo:contains('Microsoft 365'), div#productImage img)) div.m-hero-item img, section#mainArea[role=main] div.c-carousel[role=region] picture img, div#TwoColumnRegion div#ImageCollectionCarousel img, div[class*=\"image-collection-carousel\"] img, li[id*=\"media\"][class*=\"active\"] img, body:not(:has(#heroTabControls)) [id*=\"BlockList\"] [class*=\"carousel\"] img:first, body:not(:has(li[id*=\"media\"][class*=\"active\"] img)) div[id*=\"TopContentBlockList\"] img:first, html[lang=\"en-US\"] aside.productImage picture img","category_selector":"","keyword_selector":"","group_lookup_selector":null,"group_lookup_key":null,"item_lookup_selector":null,"item_lookup_key":null,"titleRegexp":"Configure your\\s --> ","imagesRegexp":"\\?.* --> || (.*) --> $1?w=2000&h=2000","itemLookupRegexp":null,"groupLookupRegexp":null,"title_selector_mobile":null,"price_selector_mobile":null,"image_selector_mobile":null,"category_selector_mobile":"","keyword_selector_mobile":"","group_lookup_selector_mobile":null,"group_lookup_key_mobile":null,"item_lookup_selector_mobile":null,"item_lookup_key_mobile":null,"titleRegexp_mobile":"","imagesRegexp_mobile":"","itemLookupRegexp_mobile":null,"groupLookupRegexp_mobile":null},"cart_link_div":null,"cart_link_div_mobile":null,"cart_link_div_extension":null,"cart_link_div_six":null,"cart_link_div_server":null,"cart_qtys_div":{"selector":"div.item-quantity-readonly, select option[selected], div.cart-product-subtitle span:contains(\"Quantity\")+","noauth_start_idx":"","auth_start_idx":"-1","local_start_idx":""},"cart_qtys_div_mobile":null,"cart_qtys_div_extension":null,"cart_qtys_div_six":null,"cart_qtys_div_server":null,"cart_wrapper_div":{"selector":"div.line-item-row .line-item:contains(\"$\"), body:has(app-signup-collect-payment #payment-wrapper) div.signupContainer, #PurchaseWizardStepReviewOrder, div.ms-Stack:has(div:contains(\"purchasing:\")):first, div[class*=\"lineItemRow\"]:not(:has(div[class*=\"lineItem-\"] + div[class*=\"bundleItems\"])):contains('$')","noauth_start_idx":"","auth_start_idx":"","local_start_idx":""},"cart_wrapper_div_mobile":null,"cart_wrapper_div_extension":null,"cart_wrapper_div_six":null,"cart_wrapper_div_server":null,"cart_p_name_div":{"selector":"div.item-description h2 a, h1 b, .cart-product-title, span[id*=\"OfferNameWithTerm\"] span[class*=\"OfferTitle\"], div[class*=\"caption\"]:contains(\"purchasing:\") + div h2, div[class*='itemDescription'] h2 a","has_custom_selector":true},"cart_p_name_div_mobile":null,"cart_p_name_div_extension":null,"cart_p_name_div_six":null,"cart_p_name_div_server":null,"cart_p_sku_div":null,"cart_p_sku_div_mobile":null,"cart_p_sku_div_extension":null,"cart_p_sku_div_six":null,"cart_p_sku_div_server":null,"cart_title_regexp":null,"cart_title_regexp_mobile":null,"cart_title_regexp_extension":null,"cart_title_regexp_six":null,"cart_title_regexp_server":null,"cart_p_url_div":{"selector":"div.item-description h2 a, div[class*='itemDescription'] h2 a","has_custom_selector":true},"cart_p_url_div_mobile":null,"cart_p_url_div_extension":null,"cart_p_url_div_six":null,"cart_p_url_div_server":null,"cart_p_image_div":{"selector":"div.item-image img, .cart-product-image img, div[class*='itemImage'] img.c-image","has_custom_selector":true},"cart_p_image_div_mobile":null,"cart_p_image_div_extension":null,"cart_p_image_div_six":null,"cart_p_image_div_server":null,"cart_p_qty_div":null,"cart_p_qty_div_mobile":null,"cart_p_qty_div_extension":null,"cart_p_qty_div_six":null,"cart_p_qty_div_server":null,"cart_p_attrs_div":{"selector":"div.item-description div:not(.c-group), ul[class*=features] i + span","has_custom_selector":true},"cart_p_attrs_div_mobile":null,"cart_p_attrs_div_extension":null,"cart_p_attrs_div_six":null,"cart_p_attrs_div_server":null,"cart_p_unit_price_div":{"selector":"[class*=\"discountedUnitPriceInfo\"]","has_custom_selector":true},"cart_p_unit_price_div_mobile":null,"cart_p_unit_price_div_extension":null,"cart_p_unit_price_div_six":null,"cart_p_unit_price_div_server":null,"cart_p_total_price_div":{"selector":"span[class *= \"listPrice\"], div.item-price div span span[itemprop=\"price\"], #product-price-cell .c-price span[itemprop=\"price\"], div.jss35:contains(\"/ user /\"), button.plan.selectedplan span.price","has_custom_selector":true},"cart_p_total_price_div_mobile":null,"cart_p_total_price_div_extension":null,"cart_p_total_price_div_six":null,"cart_p_total_price_div_server":null,"cart_p_subtotal_div":{"selector":"span:contains(\"Items (\") span[itemprop=\"price\"], span.cart-line-text:contains(\"Subtotal\")+, span:contains(\"Subtotal\") span span","has_custom_selector":true},"cart_p_subtotal_div_mobile":null,"cart_p_subtotal_div_extension":null,"cart_p_subtotal_div_six":null,"cart_p_subtotal_div_server":null,"cart_p_tax_div":{"selector":"span span:contains(\"Estimated tax\")+ :contains(\"$\"), span span:contains(\"Estimation des taxes\")+","has_custom_selector":true},"cart_p_tax_div_mobile":null,"cart_p_tax_div_extension":null,"cart_p_tax_div_six":null,"cart_p_tax_div_server":null,"cart_p_shipping_div":{"selector":"span span:contains(\"Delivery\")+, span span:contains(\"Shipping\")+ :contains(\"$\"), span span:contains(\"Expédition\")+","has_custom_selector":true},"cart_p_shipping_div_mobile":null,"cart_p_shipping_div_extension":null,"cart_p_shipping_div_six":null,"cart_p_shipping_div_server":null,"cart_total_div":{"selector":"//strong/span[@itemprop=\"price\"] | //table[@id=\"price-summary\"]//tr[last()]//p[@class=\"bold-text\"] | //div[@class=\"priceDetailsWrapper\"]//span[@class=\"showCalculating\"] | //span[@id=\"TotalQuantityLabel\"] | //div[contains(@class,\"caption\")][contains(text(),\"purchasing:\")]/following-sibling::div//span[contains(@class,\"price\")]/span[contains(text(),\"$\")] | //span[contains(@class, 'listPrice')]/span","has_custom_selector":true},"cart_total_div_mobile":null,"cart_total_div_extension":null,"cart_total_div_six":null,"cart_total_div_server":null,"cart_custom_id":null,"cart_custom_id_mobile":null,"cart_custom_id_extension":null,"cart_custom_id_six":null,"cart_custom_id_server":null,"cart_opts_retrieval_js":null,"cart_opts_retrieval_js_mobile":null,"cart_opts_retrieval_js_extension":null,"cart_opts_retrieval_js_six":null,"cart_opts_retrieval_js_server":null,"address_check_noauth":null,"address_check_noauth_mobile":null,"address_check_noauth_extension":null,"address_check_noauth_six":null,"address_check_noauth_server":null,"final_price_div_noauth":null,"final_price_div_noauth_mobile":null,"final_price_div_noauth_extension":null,"final_price_div_noauth_six":null,"final_price_div_noauth_server":null,"shipping_price_div_noauth":null,"shipping_price_div_noauth_mobile":null,"shipping_price_div_noauth_extension":null,"shipping_price_div_noauth_six":null,"shipping_price_div_noauth_server":null,"handling_price_div_noauth":null,"handling_price_div_noauth_mobile":null,"handling_price_div_noauth_extension":null,"handling_price_div_noauth_six":null,"handling_price_div_noauth_server":null,"checkout_recording_noauth":null,"checkout_recording_noauth_mobile":null,"checkout_recording_noauth_extension":null,"checkout_recording_noauth_six":null,"checkout_recording_noauth_server":null,"sales_tax_div_noauth":null,"sales_tax_div_noauth_mobile":null,"sales_tax_div_noauth_extension":null,"sales_tax_div_noauth_six":null,"sales_tax_div_noauth_server":null,"shipping_estimate_div_noauth":null,"shipping_estimate_div_noauth_mobile":null,"shipping_estimate_div_noauth_extension":null,"shipping_estimate_div_noauth_six":null,"shipping_estimate_div_noauth_server":null,"checkout_information_noauth":null,"checkout_information_noauth_mobile":null,"checkout_information_noauth_extension":null,"checkout_information_noauth_six":null,"checkout_information_noauth_server":null,"order_id_div_noauth":null,"order_id_div_noauth_mobile":null,"order_id_div_noauth_extension":null,"order_id_div_noauth_six":null,"order_id_div_noauth_server":null,"coupon_value_div_noauth":null,"coupon_value_div_noauth_mobile":null,"coupon_value_div_noauth_extension":null,"coupon_value_div_noauth_six":null,"coupon_value_div_noauth_server":null,"gift_card_value_div_noauth":null,"gift_card_value_div_noauth_mobile":null,"gift_card_value_div_noauth_extension":null,"gift_card_value_div_noauth_six":null,"gift_card_value_div_noauth_server":null,"shipping_address_div_noauth":null,"shipping_address_div_noauth_mobile":null,"shipping_address_div_noauth_extension":null,"shipping_address_div_noauth_six":null,"shipping_address_div_noauth_server":null,"site_id":{"$oid":"5d658a8778c6bd1142ca8a9a"},"has_issues":false,"changelog":"IM-232804: Fixed HG integration on store checkout for guest or registered users","add_to_cart_changes_div_mobile":null,"recording_start_urls_mobile":null,"parent_id":{"$oid":"66673298567c3d1be597bf41"},"created_at":{"$date":"2024-10-07T05:05:54.787Z"},"updated_at":{"$date":"2024-10-07T05:14:51.744Z"},"worker_honey_user_id":"8424507245273010515","activated_at":{"$date":"2024-10-07T05:14:57.021Z"},"activated_by_honey_user_id":"8424507245273010515","assignee_id":null}